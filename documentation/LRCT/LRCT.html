<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 12.0.2"/>
    <title>LRCT.LRCT API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../LRCT.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;LRCT</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#LRCTree">LRCTree</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#LRCTree.__init__">LRCTree</a>
                        </li>
                        <li>
                                <a class="variable" href="#LRCTree.max_depth">max_depth</a>
                        </li>
                        <li>
                                <a class="variable" href="#LRCTree.min_samples_split">min_samples_split</a>
                        </li>
                        <li>
                                <a class="variable" href="#LRCTree.min_samples_leaf">min_samples_leaf</a>
                        </li>
                        <li>
                                <a class="variable" href="#LRCTree.n_independent">n_independent</a>
                        </li>
                        <li>
                                <a class="variable" href="#LRCTree.highest_degree">highest_degree</a>
                        </li>
                        <li>
                                <a class="variable" href="#LRCTree.fit_intercepts">fit_intercepts</a>
                        </li>
                        <li>
                                <a class="variable" href="#LRCTree.method">method</a>
                        </li>
                        <li>
                                <a class="variable" href="#LRCTree.n_bins">n_bins</a>
                        </li>
                        <li>
                                <a class="variable" href="#LRCTree.kwargs">kwargs</a>
                        </li>
                        <li>
                                <a class="variable" href="#LRCTree.depth">depth</a>
                        </li>
                        <li>
                                <a class="variable" href="#LRCTree.nodes">nodes</a>
                        </li>
                        <li>
                                <a class="function" href="#LRCTree.describe">describe</a>
                        </li>
                        <li>
                                <a class="function" href="#LRCTree.fit">fit</a>
                        </li>
                        <li>
                                <a class="function" href="#LRCTree.predict">predict</a>
                        </li>
                        <li>
                                <a class="function" href="#LRCTree.predict_proba">predict_proba</a>
                        </li>
                        <li>
                                <a class="function" href="#LRCTree.score">score</a>
                        </li>
                        <li>
                                <a class="function" href="#LRCTree.fit_predict">fit_predict</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../LRCT.html">LRCT</a><wbr>.LRCT    </h1>

                
                        <input id="LRCT-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="LRCT-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">ClassifierMixin</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">from</span> <span class="nn">LRCT.Exceptions</span> <span class="kn">import</span> <span class="n">NotFitError</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">from</span> <span class="nn">LRCT.Node</span> <span class="kn">import</span> <span class="n">Node</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">from</span> <span class="nn">LRCT.splitting_functions</span> <span class="kn">import</span> <span class="n">find_best_lrct_split</span><span class="p">,</span> <span class="n">find_best_split</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="k">class</span> <span class="nc">LRCTree</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">):</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>    <span class="sd">&quot;&quot;&quot;Linear Regression Classification Tree</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="sd">    LRCT serves as an improved classification tree capable of making multivariate</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="sd">    linear and nonlinear splits in its training.  It does this by approximating the</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="sd">    optimal surface function across multiple variables by applying binning and linear</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="sd">    regression.</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>            <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>            <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>            <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>            <span class="n">n_independent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>            <span class="n">highest_degree</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>            <span class="n">fit_intercepts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>            <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ols&#39;</span><span class="p">,</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>            <span class="n">n_bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>            <span class="o">**</span><span class="n">kwargs</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>    <span class="p">):</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">        Parameters</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">        ----------</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">        max_depth : int or None (default None)</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">            The maximum depth the Tree can train to. If None, does not use</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">            depth as a stopping criteria</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">        min_samples_split : int (default 2)</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">            The minimum number of samples that have to be at a Node to make</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">            a split</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">        min_samples_leaf : int (default 1)</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">            The minimum number of samples that have to be at a leaf Node</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">        n_independent : int (default 1)</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">            The number of independent variables to use per multivariate split.</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">            This value can be set to 0, which will result in CART</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">        highest_degree : int (default 1)</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">            The highest degree to which to raise the independent variables</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">            in surface function learning</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">        fit_intercepts : bool (default True)</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">            Whether to fit intercepts in linear regression models</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">        method : str (default &#39;ols&#39;)</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">            One of &#39;ols&#39;, &#39;ridge&#39;, or &#39;lasso&#39;, the type of regression model to</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">            fit</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">        n_bins : int (default 10)</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">            The number of bins to use per independent variable in training</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">        **kwargs : additional keyword arguments</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">            Additional keyword arguments to pass to the linear regression models</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span> <span class="o">=</span> <span class="n">max_depth</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_split</span> <span class="o">=</span> <span class="n">min_samples_split</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_leaf</span> <span class="o">=</span> <span class="n">min_samples_leaf</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_independent</span> <span class="o">=</span> <span class="n">n_independent</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">highest_degree</span> <span class="o">=</span> <span class="n">highest_degree</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_intercepts</span> <span class="o">=</span> <span class="n">fit_intercepts</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span> <span class="o">=</span> <span class="n">n_bins</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>    <span class="nd">@property</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>    <span class="k">def</span> <span class="nf">depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span> <span class="o">==</span> <span class="p">{}:</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>            <span class="k">return</span> <span class="nb">max</span><span class="p">([</span><span class="n">n</span><span class="o">.</span><span class="n">depth</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">])</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>    <span class="nd">@property</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>    <span class="k">def</span> <span class="nf">max_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_depth</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_depth</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>    <span class="nd">@max_depth</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>    <span class="k">def</span> <span class="nf">max_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_max_depth</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>    <span class="nd">@property</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>    <span class="k">def</span> <span class="nf">min_samples_split</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_min_samples_split</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>    <span class="nd">@min_samples_split</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>    <span class="k">def</span> <span class="nf">min_samples_split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_min_samples_split</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>    <span class="nd">@property</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>    <span class="k">def</span> <span class="nf">min_samples_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_min_samples_leaf</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>    <span class="nd">@min_samples_leaf</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>    <span class="k">def</span> <span class="nf">min_samples_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_min_samples_leaf</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>    <span class="nd">@property</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>    <span class="k">def</span> <span class="nf">n_independent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_independent</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>    <span class="nd">@n_independent</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>    <span class="k">def</span> <span class="nf">n_independent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_independent</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>    <span class="nd">@property</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>    <span class="k">def</span> <span class="nf">highest_degree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_highest_degree</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>    <span class="nd">@highest_degree</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>    <span class="k">def</span> <span class="nf">highest_degree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_highest_degree</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>    <span class="nd">@property</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>    <span class="k">def</span> <span class="nf">fit_intercepts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_intercepts</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>    <span class="nd">@fit_intercepts</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>    <span class="k">def</span> <span class="nf">fit_intercepts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fit_intercepts</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>    <span class="nd">@property</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_method</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>    <span class="nd">@method</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>    <span class="nd">@property</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>    <span class="k">def</span> <span class="nf">n_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_bins</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>    <span class="nd">@n_bins</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>    <span class="k">def</span> <span class="nf">n_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_bins</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>    <span class="nd">@property</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>    <span class="k">def</span> <span class="nf">kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>    <span class="nd">@kwargs</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>    <span class="k">def</span> <span class="nf">kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>    <span class="nd">@property</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>    <span class="k">def</span> <span class="nf">nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>            <span class="k">raise</span> <span class="n">NotFitError</span><span class="p">()</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>    <span class="k">def</span> <span class="nf">_add_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">):</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>        <span class="sd">&quot;&quot;&quot;Add Nodes to the Tree</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">        Parameters</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">        ----------</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">        Nodes : Node or list of Nodes</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">            Nodes to add to the Tree</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">        Notes</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">        -----</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">        - Raises ValueError if Node is passed with identifier that already exists in Tree</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>        <span class="n">is_node</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">Node</span><span class="p">)</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>        <span class="n">acceptable_list</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">Node</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">])</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">is_node</span> <span class="ow">or</span> <span class="n">acceptable_list</span><span class="p">):</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;adding nodes requires Node objects or list of Node objects&#39;</span><span class="p">)</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>        <span class="c1"># figure out the existing IDs</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>        <span class="n">existing_ids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">id</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>        <span class="c1"># value checking for existing IDs</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>        <span class="k">if</span> <span class="n">is_node</span> <span class="ow">and</span> <span class="n">nodes</span><span class="o">.</span><span class="n">identifier</span> <span class="ow">in</span> <span class="n">existing_ids</span><span class="p">:</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Node with that ID already exists&#39;</span><span class="p">)</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>        <span class="k">if</span> <span class="n">acceptable_list</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">([</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span> <span class="ow">in</span> <span class="n">existing_ids</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">]):</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Trying to set Node with existing ID&#39;</span><span class="p">)</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>        <span class="c1"># do the actual adding of Node(s)</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>        <span class="k">if</span> <span class="n">is_node</span><span class="p">:</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="n">nodes</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">nodes</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>        <span class="k">elif</span> <span class="n">acceptable_list</span><span class="p">:</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>    <span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>        <span class="sd">&quot;&quot;&quot;Print a description of the Tree&quot;&quot;&quot;</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span> <span class="o">==</span> <span class="p">{}:</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Empty Tree&#39;</span><span class="p">)</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="n">n</span><span class="o">.</span><span class="n">depth</span><span class="si">}{</span><span class="n">n</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">values</span><span class="p">()]))</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>    <span class="k">def</span> <span class="nf">_split_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">):</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>        <span class="sd">&quot;&quot;&quot;Split a Node as in training</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="sd">        Parameters</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a><span class="sd">        ----------</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a><span class="sd">        node_id : int</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a><span class="sd">            The identifier of the Node to split</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a><span class="sd">        x_data : 2d array-like</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a><span class="sd">            The data to train from</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a><span class="sd">        y_data : array-like</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="sd">            The target values</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a><span class="sd">        Notes</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="sd">        -----</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="sd">        - If a split is found, alters the Tree by adding Nodes and altering the split of the Node</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a><span class="sd">        being split</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a><span class="sd">        Returns</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a><span class="sd">        -------</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a><span class="sd">        split_info : tuple</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a><span class="sd">            Tuple of the form (less_node_id, greater_node_id, less_x, greater_x, less_y, greater_y)</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a><span class="sd">        None : NoneType</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a><span class="sd">            If no split is found</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>        <span class="c1"># if x_data does not have more than min_samples_split rows or y_data has only one unique value, do nothing</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>        <span class="k">if</span> <span class="n">x_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_split</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_data</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>        <span class="c1"># make a copy of X and work with that</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>        <span class="n">x_copy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>        <span class="c1"># get the node, the prospective parent id, and the prospective parent depth</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="n">node_id</span><span class="p">]</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>        <span class="n">parent_id</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">identifier</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>        <span class="n">parent_depth</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">depth</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>        <span class="c1"># do not continue if already at max depth</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>        <span class="k">if</span> <span class="n">parent_depth</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span><span class="p">:</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>        <span class="n">highest_id</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>        <span class="c1"># find the split information</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>        <span class="n">best_traditional_split</span> <span class="o">=</span> <span class="n">find_best_split</span><span class="p">(</span><span class="n">x_copy</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>        <span class="n">best_lrct_split</span> <span class="o">=</span> <span class="n">find_best_lrct_split</span><span class="p">(</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>            <span class="n">x_copy</span><span class="p">,</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>            <span class="n">y_data</span><span class="p">,</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_independent</span><span class="p">,</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">highest_degree</span><span class="p">,</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit_intercepts</span><span class="p">,</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">,</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">,</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>        <span class="p">)</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>        <span class="k">if</span> <span class="n">best_traditional_split</span><span class="p">[</span><span class="s1">&#39;split_gini&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">best_lrct_split</span><span class="p">[</span><span class="s1">&#39;split_gini&#39;</span><span class="p">]:</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>            <span class="n">split</span> <span class="o">=</span> <span class="n">best_traditional_split</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>            <span class="n">split</span> <span class="o">=</span> <span class="n">best_lrct_split</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>        <span class="k">if</span> <span class="n">split</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col_idx&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>            <span class="n">less_idx</span> <span class="o">=</span> <span class="n">x_copy</span><span class="p">[:,</span> <span class="n">split</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col_idx&#39;</span><span class="p">)]</span> <span class="o">&lt;=</span> <span class="n">split</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_value&#39;</span><span class="p">)</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>            <span class="n">greater_idx</span> <span class="o">=</span> <span class="n">x_copy</span><span class="p">[:,</span> <span class="n">split</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col_idx&#39;</span><span class="p">)]</span> <span class="o">&gt;</span> <span class="n">split</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_value&#39;</span><span class="p">)</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>            <span class="n">ind</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="s1">&#39;indices&#39;</span><span class="p">]</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>            <span class="n">new_col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x_copy</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">split</span><span class="p">[</span><span class="s1">&#39;coefs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>                <span class="n">column_idx</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>                <span class="n">power</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">//</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>                <span class="n">new_col</span> <span class="o">+=</span> <span class="n">split</span><span class="p">[</span><span class="s1">&#39;coefs&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x_copy</span><span class="p">[:,</span> <span class="n">column_idx</span><span class="p">]</span><span class="o">**</span><span class="n">power</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>            <span class="n">new_col</span> <span class="o">-=</span> <span class="n">x_copy</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>            <span class="n">less_idx</span> <span class="o">=</span> <span class="n">new_col</span> <span class="o">&lt;=</span> <span class="n">split</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_value&#39;</span><span class="p">)</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>            <span class="n">greater_idx</span> <span class="o">=</span> <span class="n">new_col</span> <span class="o">&gt;</span> <span class="n">split</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_value&#39;</span><span class="p">)</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">less_idx</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_leaf</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">greater_idx</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_leaf</span><span class="p">):</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>        <span class="n">less_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>            <span class="n">highest_id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>            <span class="n">parent_id</span><span class="p">,</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>            <span class="n">parent_depth</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>        <span class="p">)</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>        <span class="n">greater_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>            <span class="n">highest_id</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>            <span class="n">parent_id</span><span class="p">,</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>            <span class="n">parent_depth</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>        <span class="p">)</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>            
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_add_nodes</span><span class="p">([</span><span class="n">less_node</span><span class="p">,</span> <span class="n">greater_node</span><span class="p">])</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="n">parent_id</span><span class="p">]</span><span class="o">.</span><span class="n">split</span> <span class="o">=</span> <span class="n">split</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>        <span class="k">return</span> <span class="n">highest_id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">highest_id</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x_copy</span><span class="p">[</span><span class="n">less_idx</span><span class="p">],</span> <span class="n">x_copy</span><span class="p">[</span><span class="n">greater_idx</span><span class="p">],</span> <span class="n">y_data</span><span class="p">[</span><span class="n">less_idx</span><span class="p">],</span> <span class="n">y_data</span><span class="p">[</span><span class="n">greater_idx</span><span class="p">]</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>        <span class="sd">&quot;&quot;&quot;Fit the Tree</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="sd">        Parameters</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">        ----------</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">        x : 2d array-like</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="sd">            The independent data to learn from</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">        y : 1d numpy array or pandas Series</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="sd">            The target to learn</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a><span class="sd">        Returns</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a><span class="sd">        -------</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="sd">        tree : LRCTree</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a><span class="sd">            The fit tree (self)</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>        <span class="c1"># typechecking</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;x must be ndarray or pandas DataFrame&#39;</span><span class="p">)</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;y must be ndarray or Series&#39;</span><span class="p">)</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;y must have a single dimension&#39;</span><span class="p">)</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>        <span class="c1"># check the shapes of each variable</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Number of records does not match number of samples&#39;</span><span class="p">)</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>        <span class="c1"># if y is pandas Series, use only values (numpy array)</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">values</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>        <span class="c1"># instantiate the Nodes</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>        <span class="c1"># add the parent Node</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_add_nodes</span><span class="p">(</span><span class="n">Node</span><span class="p">())</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>        <span class="c1"># keep a record of all Node data for record keeping -- will be lost at the end however</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="n">node_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>            <span class="mi">0</span><span class="p">:</span> <span class="p">{</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>                <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>                <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>            <span class="p">}</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>        <span class="p">}</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>        <span class="c1"># fitting logic is inside while loop</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span><span class="p">:</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>            <span class="c1"># record current depth Nodes and how many Nodes exist to determine stopping criteria later</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>            <span class="n">current_depth_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">depth</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">]</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>            <span class="n">num_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>            <span class="c1"># try to split all of the current depth Nodes</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">current_depth_nodes</span><span class="p">:</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>                <span class="n">split_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_split_node</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span><span class="p">,</span> <span class="n">node_data</span><span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>                                                 <span class="n">node_data</span><span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>                <span class="c1"># get the split information if there is an actual split to get</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>                <span class="c1"># remember -- if split_results is not None, the Node was actually split and new Nodes were added to the</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>                <span class="c1"># Tree</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>                <span class="k">if</span> <span class="n">split_results</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>                    <span class="c1"># get the data for each side</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>                    <span class="n">less_id</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>                    <span class="n">greater_id</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>                    <span class="n">x_less</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>                    <span class="n">x_greater</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>                    <span class="n">y_less</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>                    <span class="n">y_greater</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>                    <span class="c1"># create the Nodes</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>                    <span class="n">node_data</span><span class="p">[</span><span class="n">less_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>                        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x_less</span><span class="p">,</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>                        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y_less</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>                    <span class="p">}</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>                    <span class="n">node_data</span><span class="p">[</span><span class="n">greater_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>                        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x_greater</span><span class="p">,</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>                        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y_greater</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>                    <span class="p">}</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>            <span class="c1"># if no new Nodes, then we are done</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>            <span class="n">new_num_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>            <span class="k">if</span> <span class="n">new_num_nodes</span> <span class="o">==</span> <span class="n">num_nodes</span><span class="p">:</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>                <span class="k">break</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>        <span class="c1"># set _is_fit to True</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_is_fit</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>        <span class="c1"># _values_to_predict helps with predicting probabilities</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">values_to_predict_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>        <span class="c1"># _node_distributions helps with predicting</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">node_distributions_</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>            <span class="n">n</span><span class="o">.</span><span class="n">identifier</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">node_data</span><span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values_to_predict_</span><span class="p">])</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">split</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>        <span class="p">}</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>        <span class="c1"># return self for consistency with scikit-learn</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>    <span class="k">def</span> <span class="nf">_predict_single_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">proba</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>        <span class="sd">&quot;&quot;&quot;Predict a single new instance</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="sd">        Parameters</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a><span class="sd">        ----------</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a><span class="sd">        instance : 1d numpy array</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a><span class="sd">            Object which has the desired implementation of the .keys() method</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a><span class="sd">        proba : bool (default False)</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a><span class="sd">            Whether to return probabilities</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a><span class="sd">        Returns</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a><span class="sd">        -------</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a><span class="sd">        prediction : int or float</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a><span class="sd">            The class predicted or probabilities predicted</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>        <span class="c1"># start at the root Node</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>        <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>        <span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>            <span class="n">child_node_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">parent_id</span> <span class="o">==</span> <span class="n">current_node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>            <span class="k">if</span> <span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col_idx&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>                <span class="k">if</span> <span class="n">instance</span><span class="p">[</span><span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="s1">&#39;col_idx&#39;</span><span class="p">]]</span> <span class="o">&lt;=</span> <span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="s1">&#39;split_value&#39;</span><span class="p">]:</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>                    <span class="n">new_node_id</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">child_node_ids</span><span class="p">)</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>                    <span class="n">new_node_id</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">child_node_ids</span><span class="p">)</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>                <span class="n">ind</span> <span class="o">=</span> <span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="s1">&#39;indices&#39;</span><span class="p">]</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>                <span class="n">new_val</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="s1">&#39;coefs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>                    <span class="n">column_index</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>                    <span class="n">power</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">//</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>                    <span class="n">new_val</span> <span class="o">+=</span> <span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="s1">&#39;coefs&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">instance</span><span class="p">[</span><span class="n">column_index</span><span class="p">]</span><span class="o">**</span><span class="n">power</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>                <span class="n">new_val</span> <span class="o">-=</span> <span class="n">instance</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>                <span class="k">if</span> <span class="n">new_val</span> <span class="o">&lt;=</span> <span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="s1">&#39;split_value&#39;</span><span class="p">]:</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>                    <span class="n">new_node_id</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">child_node_ids</span><span class="p">)</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>                    <span class="n">new_node_id</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">child_node_ids</span><span class="p">)</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>            
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>            <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="n">new_node_id</span><span class="p">]</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>        
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>        <span class="c1"># after we&#39;re out of the while loop, get the current distribution to see what we need to predict</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>        <span class="n">current_distribution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_distributions_</span><span class="p">[</span><span class="n">current_node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>        <span class="c1"># get the probabilities</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>        <span class="n">probabilities</span> <span class="o">=</span> <span class="n">current_distribution</span> <span class="o">/</span> <span class="n">current_distribution</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>        
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>        <span class="c1"># return probabilities if asked for</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>        <span class="k">if</span> <span class="n">proba</span><span class="p">:</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>            <span class="k">return</span> <span class="n">probabilities</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>            <span class="c1"># check if there&#39;s a clear winner</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">probabilities</span> <span class="o">==</span> <span class="n">probabilities</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>                <span class="k">return</span> <span class="n">probabilities</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>            
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>            <span class="c1"># if there&#39;s no clear winner, return a random guess from the most common ones</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>            <span class="n">highest_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">probabilities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">probabilities</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">probabilities</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">highest_indices</span><span class="p">)</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>            
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>    <span class="k">def</span> <span class="nf">_predict_single_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>        <span class="sd">&quot;&quot;&quot;Predict class probabilities for a single instance</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a><span class="sd">        Parameters</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a><span class="sd">        ----------</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a><span class="sd">        instance : pd.Series or dict</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a><span class="sd">            Object which has the desired implementation of the .keys() method</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a><span class="sd">        Returns</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a><span class="sd">        -------</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a><span class="sd">        probas : numpy array</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a><span class="sd">            Array of shape (n_classes,), where n_classes is the number of classes trained on</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>        <span class="c1"># implementation of this function is similar to the implementation of _predict_single_instance</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>        <span class="c1"># except return the node distributions normalized to sum to 1</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>        <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>        <span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>            <span class="n">child_node_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">parent_id</span> <span class="o">==</span> <span class="n">current_node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>            <span class="n">split_col</span><span class="p">,</span> <span class="n">split_value</span> <span class="o">=</span> <span class="n">current_node</span><span class="o">.</span><span class="n">split</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>            <span class="k">if</span> <span class="n">split_col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>                <span class="n">rest</span><span class="p">,</span> <span class="n">last_col</span> <span class="o">=</span> <span class="n">split_col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; - &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">split_col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; - &#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>                <span class="n">new_coefs</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">rest</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; + &#39;</span><span class="p">)]</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>                <span class="n">new_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;^&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">rest</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; + &#39;</span><span class="p">)]</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>                <span class="n">new_col_components</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_coefs</span><span class="p">)):</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>                    <span class="k">if</span> <span class="s1">&#39;^&#39;</span> <span class="ow">in</span> <span class="n">new_cols</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>                        <span class="n">col</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">new_cols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;^&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">new_cols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;^&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>                        <span class="n">new_col_components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">new_coefs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">*instance[&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&quot;]**</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>                        <span class="n">new_col_components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">new_coefs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">*instance[&quot;</span><span class="si">{</span><span class="n">new_cols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot;]&#39;</span><span class="p">)</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>                <span class="n">new_col_str</span> <span class="o">=</span> <span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_col_components</span><span class="p">)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>                <span class="n">new_col_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; - instance[&quot;</span><span class="si">{</span><span class="n">last_col</span><span class="si">}</span><span class="s1">&quot;]&#39;</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>                <span class="n">val_to_check</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">new_col_str</span><span class="p">)</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>                <span class="n">val_to_check</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="n">split_col</span><span class="p">]</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>            <span class="k">if</span> <span class="n">val_to_check</span> <span class="o">&lt;=</span> <span class="n">split_value</span><span class="p">:</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>                <span class="n">new_node_id</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">child_node_ids</span><span class="p">)</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>                <span class="n">new_node_id</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">child_node_ids</span><span class="p">)</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>            <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="n">new_node_id</span><span class="p">]</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_distributions_</span><span class="p">[</span><span class="n">current_node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_distributions_</span><span class="p">[</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>            <span class="n">current_node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>        <span class="sd">&quot;&quot;&quot;Predict classes for a set of values</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a><span class="sd">        Parameters</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a><span class="sd">        ----------</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a><span class="sd">        x : pandas DataFrame</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a><span class="sd">            Data to predict from</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a><span class="sd">        Returns</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a><span class="sd">        -------</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a><span class="sd">        preds : numpy array</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a><span class="sd">            Numpy array of predictions</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_fit</span><span class="p">:</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>            <span class="k">raise</span> <span class="n">NotFitError</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>        <span class="c1"># this function just applies the _predict_single_instance method to each of the rows</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_single_instance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">proba</span> <span class="o">=</span> <span class="kc">False</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>        <span class="sd">&quot;&quot;&quot;Predict class probabilities for a set of values</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a><span class="sd">        Parameters</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a><span class="sd">        ----------</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a><span class="sd">        x : 2d array-like</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a><span class="sd">            Data to predict from</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a><span class="sd">        Returns</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a><span class="sd">        -------</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a><span class="sd">        preds : numpy array</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a><span class="sd">            Numpy array of predicted probabilities. Column indices correspond to same classes</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_fit</span><span class="p">:</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>            <span class="k">raise</span> <span class="n">NotFitError</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>        <span class="c1"># apply predicting with probabilities</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_single_instance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">proba</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>        <span class="sd">&quot;&quot;&quot;Score the model&#39;s performance on new labeled data using accuracy score as a measure</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a><span class="sd">        Parameters</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a><span class="sd">        ----------</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a><span class="sd">        x : pandas DataFrame</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a><span class="sd">            DataFrame to predict from</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a><span class="sd">        y : pandas Series or 1d numpy array</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a><span class="sd">            Labels for data</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a><span class="sd">        Returns</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a><span class="sd">        -------</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a><span class="sd">        score : float</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a><span class="sd">            Accuracy score of the model on its predictions of x</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>        <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>        <span class="k">return</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>    <span class="k">def</span> <span class="nf">fit_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>        <span class="sd">&quot;&quot;&quot;Fit the model and predict on X</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a><span class="sd">        Parameters</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a><span class="sd">        ----------</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a><span class="sd">        x : pandas DataFrame</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a><span class="sd">            DataFrame to train on and predict from</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a><span class="sd">        y : pandas Series or 1d numpy array</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a><span class="sd">            Labels for x to learn from</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a><span class="sd">        Returns</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a><span class="sd">        -------</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a><span class="sd">        preds : 1d numpy array</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a><span class="sd">            Predictions on x after fitting</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="LRCTree">
                            <input id="LRCTree-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">LRCTree</span><wbr>(<span class="base">sklearn.base.BaseEstimator</span>, <span class="base">sklearn.base.ClassifierMixin</span>):

                <label class="view-source-button" for="LRCTree-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LRCTree"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LRCTree-12"><a href="#LRCTree-12"><span class="linenos"> 12</span></a><span class="k">class</span> <span class="nc">LRCTree</span><span class="p">(</span><span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">ClassifierMixin</span><span class="p">):</span>
</span><span id="LRCTree-13"><a href="#LRCTree-13"><span class="linenos"> 13</span></a>    <span class="sd">&quot;&quot;&quot;Linear Regression Classification Tree</span>
</span><span id="LRCTree-14"><a href="#LRCTree-14"><span class="linenos"> 14</span></a>
</span><span id="LRCTree-15"><a href="#LRCTree-15"><span class="linenos"> 15</span></a><span class="sd">    LRCT serves as an improved classification tree capable of making multivariate</span>
</span><span id="LRCTree-16"><a href="#LRCTree-16"><span class="linenos"> 16</span></a><span class="sd">    linear and nonlinear splits in its training.  It does this by approximating the</span>
</span><span id="LRCTree-17"><a href="#LRCTree-17"><span class="linenos"> 17</span></a><span class="sd">    optimal surface function across multiple variables by applying binning and linear</span>
</span><span id="LRCTree-18"><a href="#LRCTree-18"><span class="linenos"> 18</span></a><span class="sd">    regression.</span>
</span><span id="LRCTree-19"><a href="#LRCTree-19"><span class="linenos"> 19</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LRCTree-20"><a href="#LRCTree-20"><span class="linenos"> 20</span></a>
</span><span id="LRCTree-21"><a href="#LRCTree-21"><span class="linenos"> 21</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="LRCTree-22"><a href="#LRCTree-22"><span class="linenos"> 22</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="LRCTree-23"><a href="#LRCTree-23"><span class="linenos"> 23</span></a>            <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LRCTree-24"><a href="#LRCTree-24"><span class="linenos"> 24</span></a>            <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="LRCTree-25"><a href="#LRCTree-25"><span class="linenos"> 25</span></a>            <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LRCTree-26"><a href="#LRCTree-26"><span class="linenos"> 26</span></a>            <span class="n">n_independent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LRCTree-27"><a href="#LRCTree-27"><span class="linenos"> 27</span></a>            <span class="n">highest_degree</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LRCTree-28"><a href="#LRCTree-28"><span class="linenos"> 28</span></a>            <span class="n">fit_intercepts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LRCTree-29"><a href="#LRCTree-29"><span class="linenos"> 29</span></a>            <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ols&#39;</span><span class="p">,</span>
</span><span id="LRCTree-30"><a href="#LRCTree-30"><span class="linenos"> 30</span></a>            <span class="n">n_bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="LRCTree-31"><a href="#LRCTree-31"><span class="linenos"> 31</span></a>            <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LRCTree-32"><a href="#LRCTree-32"><span class="linenos"> 32</span></a>    <span class="p">):</span>
</span><span id="LRCTree-33"><a href="#LRCTree-33"><span class="linenos"> 33</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="LRCTree-34"><a href="#LRCTree-34"><span class="linenos"> 34</span></a><span class="sd">        Parameters</span>
</span><span id="LRCTree-35"><a href="#LRCTree-35"><span class="linenos"> 35</span></a><span class="sd">        ----------</span>
</span><span id="LRCTree-36"><a href="#LRCTree-36"><span class="linenos"> 36</span></a><span class="sd">        max_depth : int or None (default None)</span>
</span><span id="LRCTree-37"><a href="#LRCTree-37"><span class="linenos"> 37</span></a><span class="sd">            The maximum depth the Tree can train to. If None, does not use</span>
</span><span id="LRCTree-38"><a href="#LRCTree-38"><span class="linenos"> 38</span></a><span class="sd">            depth as a stopping criteria</span>
</span><span id="LRCTree-39"><a href="#LRCTree-39"><span class="linenos"> 39</span></a><span class="sd">        min_samples_split : int (default 2)</span>
</span><span id="LRCTree-40"><a href="#LRCTree-40"><span class="linenos"> 40</span></a><span class="sd">            The minimum number of samples that have to be at a Node to make</span>
</span><span id="LRCTree-41"><a href="#LRCTree-41"><span class="linenos"> 41</span></a><span class="sd">            a split</span>
</span><span id="LRCTree-42"><a href="#LRCTree-42"><span class="linenos"> 42</span></a><span class="sd">        min_samples_leaf : int (default 1)</span>
</span><span id="LRCTree-43"><a href="#LRCTree-43"><span class="linenos"> 43</span></a><span class="sd">            The minimum number of samples that have to be at a leaf Node</span>
</span><span id="LRCTree-44"><a href="#LRCTree-44"><span class="linenos"> 44</span></a><span class="sd">        n_independent : int (default 1)</span>
</span><span id="LRCTree-45"><a href="#LRCTree-45"><span class="linenos"> 45</span></a><span class="sd">            The number of independent variables to use per multivariate split.</span>
</span><span id="LRCTree-46"><a href="#LRCTree-46"><span class="linenos"> 46</span></a><span class="sd">            This value can be set to 0, which will result in CART</span>
</span><span id="LRCTree-47"><a href="#LRCTree-47"><span class="linenos"> 47</span></a><span class="sd">        highest_degree : int (default 1)</span>
</span><span id="LRCTree-48"><a href="#LRCTree-48"><span class="linenos"> 48</span></a><span class="sd">            The highest degree to which to raise the independent variables</span>
</span><span id="LRCTree-49"><a href="#LRCTree-49"><span class="linenos"> 49</span></a><span class="sd">            in surface function learning</span>
</span><span id="LRCTree-50"><a href="#LRCTree-50"><span class="linenos"> 50</span></a><span class="sd">        fit_intercepts : bool (default True)</span>
</span><span id="LRCTree-51"><a href="#LRCTree-51"><span class="linenos"> 51</span></a><span class="sd">            Whether to fit intercepts in linear regression models</span>
</span><span id="LRCTree-52"><a href="#LRCTree-52"><span class="linenos"> 52</span></a><span class="sd">        method : str (default &#39;ols&#39;)</span>
</span><span id="LRCTree-53"><a href="#LRCTree-53"><span class="linenos"> 53</span></a><span class="sd">            One of &#39;ols&#39;, &#39;ridge&#39;, or &#39;lasso&#39;, the type of regression model to</span>
</span><span id="LRCTree-54"><a href="#LRCTree-54"><span class="linenos"> 54</span></a><span class="sd">            fit</span>
</span><span id="LRCTree-55"><a href="#LRCTree-55"><span class="linenos"> 55</span></a><span class="sd">        n_bins : int (default 10)</span>
</span><span id="LRCTree-56"><a href="#LRCTree-56"><span class="linenos"> 56</span></a><span class="sd">            The number of bins to use per independent variable in training</span>
</span><span id="LRCTree-57"><a href="#LRCTree-57"><span class="linenos"> 57</span></a><span class="sd">        **kwargs : additional keyword arguments</span>
</span><span id="LRCTree-58"><a href="#LRCTree-58"><span class="linenos"> 58</span></a><span class="sd">            Additional keyword arguments to pass to the linear regression models</span>
</span><span id="LRCTree-59"><a href="#LRCTree-59"><span class="linenos"> 59</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LRCTree-60"><a href="#LRCTree-60"><span class="linenos"> 60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span> <span class="o">=</span> <span class="n">max_depth</span>
</span><span id="LRCTree-61"><a href="#LRCTree-61"><span class="linenos"> 61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_split</span> <span class="o">=</span> <span class="n">min_samples_split</span>
</span><span id="LRCTree-62"><a href="#LRCTree-62"><span class="linenos"> 62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_leaf</span> <span class="o">=</span> <span class="n">min_samples_leaf</span>
</span><span id="LRCTree-63"><a href="#LRCTree-63"><span class="linenos"> 63</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_independent</span> <span class="o">=</span> <span class="n">n_independent</span>
</span><span id="LRCTree-64"><a href="#LRCTree-64"><span class="linenos"> 64</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">highest_degree</span> <span class="o">=</span> <span class="n">highest_degree</span>
</span><span id="LRCTree-65"><a href="#LRCTree-65"><span class="linenos"> 65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_intercepts</span> <span class="o">=</span> <span class="n">fit_intercepts</span>
</span><span id="LRCTree-66"><a href="#LRCTree-66"><span class="linenos"> 66</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
</span><span id="LRCTree-67"><a href="#LRCTree-67"><span class="linenos"> 67</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span> <span class="o">=</span> <span class="n">n_bins</span>
</span><span id="LRCTree-68"><a href="#LRCTree-68"><span class="linenos"> 68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
</span><span id="LRCTree-69"><a href="#LRCTree-69"><span class="linenos"> 69</span></a>
</span><span id="LRCTree-70"><a href="#LRCTree-70"><span class="linenos"> 70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LRCTree-71"><a href="#LRCTree-71"><span class="linenos"> 71</span></a>
</span><span id="LRCTree-72"><a href="#LRCTree-72"><span class="linenos"> 72</span></a>    <span class="nd">@property</span>
</span><span id="LRCTree-73"><a href="#LRCTree-73"><span class="linenos"> 73</span></a>    <span class="k">def</span> <span class="nf">depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LRCTree-74"><a href="#LRCTree-74"><span class="linenos"> 74</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span> <span class="o">==</span> <span class="p">{}:</span>
</span><span id="LRCTree-75"><a href="#LRCTree-75"><span class="linenos"> 75</span></a>            <span class="k">return</span> <span class="mi">0</span>
</span><span id="LRCTree-76"><a href="#LRCTree-76"><span class="linenos"> 76</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LRCTree-77"><a href="#LRCTree-77"><span class="linenos"> 77</span></a>            <span class="k">return</span> <span class="nb">max</span><span class="p">([</span><span class="n">n</span><span class="o">.</span><span class="n">depth</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">])</span>
</span><span id="LRCTree-78"><a href="#LRCTree-78"><span class="linenos"> 78</span></a>
</span><span id="LRCTree-79"><a href="#LRCTree-79"><span class="linenos"> 79</span></a>    <span class="nd">@property</span>
</span><span id="LRCTree-80"><a href="#LRCTree-80"><span class="linenos"> 80</span></a>    <span class="k">def</span> <span class="nf">max_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LRCTree-81"><a href="#LRCTree-81"><span class="linenos"> 81</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_depth</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_depth</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
</span><span id="LRCTree-82"><a href="#LRCTree-82"><span class="linenos"> 82</span></a>
</span><span id="LRCTree-83"><a href="#LRCTree-83"><span class="linenos"> 83</span></a>    <span class="nd">@max_depth</span><span class="o">.</span><span class="n">setter</span>
</span><span id="LRCTree-84"><a href="#LRCTree-84"><span class="linenos"> 84</span></a>    <span class="k">def</span> <span class="nf">max_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="LRCTree-85"><a href="#LRCTree-85"><span class="linenos"> 85</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_max_depth</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="LRCTree-86"><a href="#LRCTree-86"><span class="linenos"> 86</span></a>
</span><span id="LRCTree-87"><a href="#LRCTree-87"><span class="linenos"> 87</span></a>    <span class="nd">@property</span>
</span><span id="LRCTree-88"><a href="#LRCTree-88"><span class="linenos"> 88</span></a>    <span class="k">def</span> <span class="nf">min_samples_split</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LRCTree-89"><a href="#LRCTree-89"><span class="linenos"> 89</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_min_samples_split</span>
</span><span id="LRCTree-90"><a href="#LRCTree-90"><span class="linenos"> 90</span></a>
</span><span id="LRCTree-91"><a href="#LRCTree-91"><span class="linenos"> 91</span></a>    <span class="nd">@min_samples_split</span><span class="o">.</span><span class="n">setter</span>
</span><span id="LRCTree-92"><a href="#LRCTree-92"><span class="linenos"> 92</span></a>    <span class="k">def</span> <span class="nf">min_samples_split</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="LRCTree-93"><a href="#LRCTree-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_min_samples_split</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="LRCTree-94"><a href="#LRCTree-94"><span class="linenos"> 94</span></a>
</span><span id="LRCTree-95"><a href="#LRCTree-95"><span class="linenos"> 95</span></a>    <span class="nd">@property</span>
</span><span id="LRCTree-96"><a href="#LRCTree-96"><span class="linenos"> 96</span></a>    <span class="k">def</span> <span class="nf">min_samples_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LRCTree-97"><a href="#LRCTree-97"><span class="linenos"> 97</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_min_samples_leaf</span>
</span><span id="LRCTree-98"><a href="#LRCTree-98"><span class="linenos"> 98</span></a>
</span><span id="LRCTree-99"><a href="#LRCTree-99"><span class="linenos"> 99</span></a>    <span class="nd">@min_samples_leaf</span><span class="o">.</span><span class="n">setter</span>
</span><span id="LRCTree-100"><a href="#LRCTree-100"><span class="linenos">100</span></a>    <span class="k">def</span> <span class="nf">min_samples_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="LRCTree-101"><a href="#LRCTree-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_min_samples_leaf</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="LRCTree-102"><a href="#LRCTree-102"><span class="linenos">102</span></a>
</span><span id="LRCTree-103"><a href="#LRCTree-103"><span class="linenos">103</span></a>    <span class="nd">@property</span>
</span><span id="LRCTree-104"><a href="#LRCTree-104"><span class="linenos">104</span></a>    <span class="k">def</span> <span class="nf">n_independent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LRCTree-105"><a href="#LRCTree-105"><span class="linenos">105</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_independent</span>
</span><span id="LRCTree-106"><a href="#LRCTree-106"><span class="linenos">106</span></a>
</span><span id="LRCTree-107"><a href="#LRCTree-107"><span class="linenos">107</span></a>    <span class="nd">@n_independent</span><span class="o">.</span><span class="n">setter</span>
</span><span id="LRCTree-108"><a href="#LRCTree-108"><span class="linenos">108</span></a>    <span class="k">def</span> <span class="nf">n_independent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="LRCTree-109"><a href="#LRCTree-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_independent</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="LRCTree-110"><a href="#LRCTree-110"><span class="linenos">110</span></a>
</span><span id="LRCTree-111"><a href="#LRCTree-111"><span class="linenos">111</span></a>    <span class="nd">@property</span>
</span><span id="LRCTree-112"><a href="#LRCTree-112"><span class="linenos">112</span></a>    <span class="k">def</span> <span class="nf">highest_degree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LRCTree-113"><a href="#LRCTree-113"><span class="linenos">113</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_highest_degree</span>
</span><span id="LRCTree-114"><a href="#LRCTree-114"><span class="linenos">114</span></a>
</span><span id="LRCTree-115"><a href="#LRCTree-115"><span class="linenos">115</span></a>    <span class="nd">@highest_degree</span><span class="o">.</span><span class="n">setter</span>
</span><span id="LRCTree-116"><a href="#LRCTree-116"><span class="linenos">116</span></a>    <span class="k">def</span> <span class="nf">highest_degree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="LRCTree-117"><a href="#LRCTree-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_highest_degree</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="LRCTree-118"><a href="#LRCTree-118"><span class="linenos">118</span></a>
</span><span id="LRCTree-119"><a href="#LRCTree-119"><span class="linenos">119</span></a>    <span class="nd">@property</span>
</span><span id="LRCTree-120"><a href="#LRCTree-120"><span class="linenos">120</span></a>    <span class="k">def</span> <span class="nf">fit_intercepts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LRCTree-121"><a href="#LRCTree-121"><span class="linenos">121</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit_intercepts</span>
</span><span id="LRCTree-122"><a href="#LRCTree-122"><span class="linenos">122</span></a>
</span><span id="LRCTree-123"><a href="#LRCTree-123"><span class="linenos">123</span></a>    <span class="nd">@fit_intercepts</span><span class="o">.</span><span class="n">setter</span>
</span><span id="LRCTree-124"><a href="#LRCTree-124"><span class="linenos">124</span></a>    <span class="k">def</span> <span class="nf">fit_intercepts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="LRCTree-125"><a href="#LRCTree-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fit_intercepts</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="LRCTree-126"><a href="#LRCTree-126"><span class="linenos">126</span></a>
</span><span id="LRCTree-127"><a href="#LRCTree-127"><span class="linenos">127</span></a>    <span class="nd">@property</span>
</span><span id="LRCTree-128"><a href="#LRCTree-128"><span class="linenos">128</span></a>    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LRCTree-129"><a href="#LRCTree-129"><span class="linenos">129</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_method</span>
</span><span id="LRCTree-130"><a href="#LRCTree-130"><span class="linenos">130</span></a>
</span><span id="LRCTree-131"><a href="#LRCTree-131"><span class="linenos">131</span></a>    <span class="nd">@method</span><span class="o">.</span><span class="n">setter</span>
</span><span id="LRCTree-132"><a href="#LRCTree-132"><span class="linenos">132</span></a>    <span class="k">def</span> <span class="nf">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="LRCTree-133"><a href="#LRCTree-133"><span class="linenos">133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_method</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="LRCTree-134"><a href="#LRCTree-134"><span class="linenos">134</span></a>
</span><span id="LRCTree-135"><a href="#LRCTree-135"><span class="linenos">135</span></a>    <span class="nd">@property</span>
</span><span id="LRCTree-136"><a href="#LRCTree-136"><span class="linenos">136</span></a>    <span class="k">def</span> <span class="nf">n_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LRCTree-137"><a href="#LRCTree-137"><span class="linenos">137</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_bins</span>
</span><span id="LRCTree-138"><a href="#LRCTree-138"><span class="linenos">138</span></a>
</span><span id="LRCTree-139"><a href="#LRCTree-139"><span class="linenos">139</span></a>    <span class="nd">@n_bins</span><span class="o">.</span><span class="n">setter</span>
</span><span id="LRCTree-140"><a href="#LRCTree-140"><span class="linenos">140</span></a>    <span class="k">def</span> <span class="nf">n_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="LRCTree-141"><a href="#LRCTree-141"><span class="linenos">141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_bins</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="LRCTree-142"><a href="#LRCTree-142"><span class="linenos">142</span></a>
</span><span id="LRCTree-143"><a href="#LRCTree-143"><span class="linenos">143</span></a>    <span class="nd">@property</span>
</span><span id="LRCTree-144"><a href="#LRCTree-144"><span class="linenos">144</span></a>    <span class="k">def</span> <span class="nf">kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LRCTree-145"><a href="#LRCTree-145"><span class="linenos">145</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span>
</span><span id="LRCTree-146"><a href="#LRCTree-146"><span class="linenos">146</span></a>
</span><span id="LRCTree-147"><a href="#LRCTree-147"><span class="linenos">147</span></a>    <span class="nd">@kwargs</span><span class="o">.</span><span class="n">setter</span>
</span><span id="LRCTree-148"><a href="#LRCTree-148"><span class="linenos">148</span></a>    <span class="k">def</span> <span class="nf">kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="LRCTree-149"><a href="#LRCTree-149"><span class="linenos">149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_kwargs</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="LRCTree-150"><a href="#LRCTree-150"><span class="linenos">150</span></a>
</span><span id="LRCTree-151"><a href="#LRCTree-151"><span class="linenos">151</span></a>    <span class="nd">@property</span>
</span><span id="LRCTree-152"><a href="#LRCTree-152"><span class="linenos">152</span></a>    <span class="k">def</span> <span class="nf">nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LRCTree-153"><a href="#LRCTree-153"><span class="linenos">153</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="LRCTree-154"><a href="#LRCTree-154"><span class="linenos">154</span></a>            <span class="k">return</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
</span><span id="LRCTree-155"><a href="#LRCTree-155"><span class="linenos">155</span></a>        <span class="k">except</span><span class="p">:</span>
</span><span id="LRCTree-156"><a href="#LRCTree-156"><span class="linenos">156</span></a>            <span class="k">raise</span> <span class="n">NotFitError</span><span class="p">()</span>
</span><span id="LRCTree-157"><a href="#LRCTree-157"><span class="linenos">157</span></a>
</span><span id="LRCTree-158"><a href="#LRCTree-158"><span class="linenos">158</span></a>    <span class="k">def</span> <span class="nf">_add_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">):</span>
</span><span id="LRCTree-159"><a href="#LRCTree-159"><span class="linenos">159</span></a>        <span class="sd">&quot;&quot;&quot;Add Nodes to the Tree</span>
</span><span id="LRCTree-160"><a href="#LRCTree-160"><span class="linenos">160</span></a>
</span><span id="LRCTree-161"><a href="#LRCTree-161"><span class="linenos">161</span></a><span class="sd">        Parameters</span>
</span><span id="LRCTree-162"><a href="#LRCTree-162"><span class="linenos">162</span></a><span class="sd">        ----------</span>
</span><span id="LRCTree-163"><a href="#LRCTree-163"><span class="linenos">163</span></a><span class="sd">        Nodes : Node or list of Nodes</span>
</span><span id="LRCTree-164"><a href="#LRCTree-164"><span class="linenos">164</span></a><span class="sd">            Nodes to add to the Tree</span>
</span><span id="LRCTree-165"><a href="#LRCTree-165"><span class="linenos">165</span></a>
</span><span id="LRCTree-166"><a href="#LRCTree-166"><span class="linenos">166</span></a><span class="sd">        Notes</span>
</span><span id="LRCTree-167"><a href="#LRCTree-167"><span class="linenos">167</span></a><span class="sd">        -----</span>
</span><span id="LRCTree-168"><a href="#LRCTree-168"><span class="linenos">168</span></a><span class="sd">        - Raises ValueError if Node is passed with identifier that already exists in Tree</span>
</span><span id="LRCTree-169"><a href="#LRCTree-169"><span class="linenos">169</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LRCTree-170"><a href="#LRCTree-170"><span class="linenos">170</span></a>        <span class="n">is_node</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">Node</span><span class="p">)</span>
</span><span id="LRCTree-171"><a href="#LRCTree-171"><span class="linenos">171</span></a>        <span class="n">acceptable_list</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">Node</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">])</span>
</span><span id="LRCTree-172"><a href="#LRCTree-172"><span class="linenos">172</span></a>
</span><span id="LRCTree-173"><a href="#LRCTree-173"><span class="linenos">173</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">is_node</span> <span class="ow">or</span> <span class="n">acceptable_list</span><span class="p">):</span>
</span><span id="LRCTree-174"><a href="#LRCTree-174"><span class="linenos">174</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;adding nodes requires Node objects or list of Node objects&#39;</span><span class="p">)</span>
</span><span id="LRCTree-175"><a href="#LRCTree-175"><span class="linenos">175</span></a>
</span><span id="LRCTree-176"><a href="#LRCTree-176"><span class="linenos">176</span></a>        <span class="c1"># figure out the existing IDs</span>
</span><span id="LRCTree-177"><a href="#LRCTree-177"><span class="linenos">177</span></a>        <span class="n">existing_ids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">id</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
</span><span id="LRCTree-178"><a href="#LRCTree-178"><span class="linenos">178</span></a>
</span><span id="LRCTree-179"><a href="#LRCTree-179"><span class="linenos">179</span></a>        <span class="c1"># value checking for existing IDs</span>
</span><span id="LRCTree-180"><a href="#LRCTree-180"><span class="linenos">180</span></a>        <span class="k">if</span> <span class="n">is_node</span> <span class="ow">and</span> <span class="n">nodes</span><span class="o">.</span><span class="n">identifier</span> <span class="ow">in</span> <span class="n">existing_ids</span><span class="p">:</span>
</span><span id="LRCTree-181"><a href="#LRCTree-181"><span class="linenos">181</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Node with that ID already exists&#39;</span><span class="p">)</span>
</span><span id="LRCTree-182"><a href="#LRCTree-182"><span class="linenos">182</span></a>        <span class="k">if</span> <span class="n">acceptable_list</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">([</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span> <span class="ow">in</span> <span class="n">existing_ids</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">]):</span>
</span><span id="LRCTree-183"><a href="#LRCTree-183"><span class="linenos">183</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Trying to set Node with existing ID&#39;</span><span class="p">)</span>
</span><span id="LRCTree-184"><a href="#LRCTree-184"><span class="linenos">184</span></a>
</span><span id="LRCTree-185"><a href="#LRCTree-185"><span class="linenos">185</span></a>        <span class="c1"># do the actual adding of Node(s)</span>
</span><span id="LRCTree-186"><a href="#LRCTree-186"><span class="linenos">186</span></a>        <span class="k">if</span> <span class="n">is_node</span><span class="p">:</span>
</span><span id="LRCTree-187"><a href="#LRCTree-187"><span class="linenos">187</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="n">nodes</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">nodes</span>
</span><span id="LRCTree-188"><a href="#LRCTree-188"><span class="linenos">188</span></a>        <span class="k">elif</span> <span class="n">acceptable_list</span><span class="p">:</span>
</span><span id="LRCTree-189"><a href="#LRCTree-189"><span class="linenos">189</span></a>            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
</span><span id="LRCTree-190"><a href="#LRCTree-190"><span class="linenos">190</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
</span><span id="LRCTree-191"><a href="#LRCTree-191"><span class="linenos">191</span></a>
</span><span id="LRCTree-192"><a href="#LRCTree-192"><span class="linenos">192</span></a>    <span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LRCTree-193"><a href="#LRCTree-193"><span class="linenos">193</span></a>        <span class="sd">&quot;&quot;&quot;Print a description of the Tree&quot;&quot;&quot;</span>
</span><span id="LRCTree-194"><a href="#LRCTree-194"><span class="linenos">194</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span> <span class="o">==</span> <span class="p">{}:</span>
</span><span id="LRCTree-195"><a href="#LRCTree-195"><span class="linenos">195</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Empty Tree&#39;</span><span class="p">)</span>
</span><span id="LRCTree-196"><a href="#LRCTree-196"><span class="linenos">196</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LRCTree-197"><a href="#LRCTree-197"><span class="linenos">197</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="n">n</span><span class="o">.</span><span class="n">depth</span><span class="si">}{</span><span class="n">n</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">values</span><span class="p">()]))</span>
</span><span id="LRCTree-198"><a href="#LRCTree-198"><span class="linenos">198</span></a>
</span><span id="LRCTree-199"><a href="#LRCTree-199"><span class="linenos">199</span></a>    <span class="k">def</span> <span class="nf">_split_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node_id</span><span class="p">,</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">):</span>
</span><span id="LRCTree-200"><a href="#LRCTree-200"><span class="linenos">200</span></a>        <span class="sd">&quot;&quot;&quot;Split a Node as in training</span>
</span><span id="LRCTree-201"><a href="#LRCTree-201"><span class="linenos">201</span></a>
</span><span id="LRCTree-202"><a href="#LRCTree-202"><span class="linenos">202</span></a><span class="sd">        Parameters</span>
</span><span id="LRCTree-203"><a href="#LRCTree-203"><span class="linenos">203</span></a><span class="sd">        ----------</span>
</span><span id="LRCTree-204"><a href="#LRCTree-204"><span class="linenos">204</span></a><span class="sd">        node_id : int</span>
</span><span id="LRCTree-205"><a href="#LRCTree-205"><span class="linenos">205</span></a><span class="sd">            The identifier of the Node to split</span>
</span><span id="LRCTree-206"><a href="#LRCTree-206"><span class="linenos">206</span></a><span class="sd">        x_data : 2d array-like</span>
</span><span id="LRCTree-207"><a href="#LRCTree-207"><span class="linenos">207</span></a><span class="sd">            The data to train from</span>
</span><span id="LRCTree-208"><a href="#LRCTree-208"><span class="linenos">208</span></a><span class="sd">        y_data : array-like</span>
</span><span id="LRCTree-209"><a href="#LRCTree-209"><span class="linenos">209</span></a><span class="sd">            The target values</span>
</span><span id="LRCTree-210"><a href="#LRCTree-210"><span class="linenos">210</span></a>
</span><span id="LRCTree-211"><a href="#LRCTree-211"><span class="linenos">211</span></a><span class="sd">        Notes</span>
</span><span id="LRCTree-212"><a href="#LRCTree-212"><span class="linenos">212</span></a><span class="sd">        -----</span>
</span><span id="LRCTree-213"><a href="#LRCTree-213"><span class="linenos">213</span></a><span class="sd">        - If a split is found, alters the Tree by adding Nodes and altering the split of the Node</span>
</span><span id="LRCTree-214"><a href="#LRCTree-214"><span class="linenos">214</span></a><span class="sd">        being split</span>
</span><span id="LRCTree-215"><a href="#LRCTree-215"><span class="linenos">215</span></a>
</span><span id="LRCTree-216"><a href="#LRCTree-216"><span class="linenos">216</span></a><span class="sd">        Returns</span>
</span><span id="LRCTree-217"><a href="#LRCTree-217"><span class="linenos">217</span></a><span class="sd">        -------</span>
</span><span id="LRCTree-218"><a href="#LRCTree-218"><span class="linenos">218</span></a><span class="sd">        split_info : tuple</span>
</span><span id="LRCTree-219"><a href="#LRCTree-219"><span class="linenos">219</span></a><span class="sd">            Tuple of the form (less_node_id, greater_node_id, less_x, greater_x, less_y, greater_y)</span>
</span><span id="LRCTree-220"><a href="#LRCTree-220"><span class="linenos">220</span></a><span class="sd">        None : NoneType</span>
</span><span id="LRCTree-221"><a href="#LRCTree-221"><span class="linenos">221</span></a><span class="sd">            If no split is found</span>
</span><span id="LRCTree-222"><a href="#LRCTree-222"><span class="linenos">222</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LRCTree-223"><a href="#LRCTree-223"><span class="linenos">223</span></a>        <span class="c1"># if x_data does not have more than min_samples_split rows or y_data has only one unique value, do nothing</span>
</span><span id="LRCTree-224"><a href="#LRCTree-224"><span class="linenos">224</span></a>        <span class="k">if</span> <span class="n">x_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_split</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y_data</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="LRCTree-225"><a href="#LRCTree-225"><span class="linenos">225</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="LRCTree-226"><a href="#LRCTree-226"><span class="linenos">226</span></a>
</span><span id="LRCTree-227"><a href="#LRCTree-227"><span class="linenos">227</span></a>        <span class="c1"># make a copy of X and work with that</span>
</span><span id="LRCTree-228"><a href="#LRCTree-228"><span class="linenos">228</span></a>        <span class="n">x_copy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="LRCTree-229"><a href="#LRCTree-229"><span class="linenos">229</span></a>
</span><span id="LRCTree-230"><a href="#LRCTree-230"><span class="linenos">230</span></a>        <span class="c1"># get the node, the prospective parent id, and the prospective parent depth</span>
</span><span id="LRCTree-231"><a href="#LRCTree-231"><span class="linenos">231</span></a>        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="n">node_id</span><span class="p">]</span>
</span><span id="LRCTree-232"><a href="#LRCTree-232"><span class="linenos">232</span></a>        <span class="n">parent_id</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">identifier</span>
</span><span id="LRCTree-233"><a href="#LRCTree-233"><span class="linenos">233</span></a>        <span class="n">parent_depth</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">depth</span>
</span><span id="LRCTree-234"><a href="#LRCTree-234"><span class="linenos">234</span></a>
</span><span id="LRCTree-235"><a href="#LRCTree-235"><span class="linenos">235</span></a>        <span class="c1"># do not continue if already at max depth</span>
</span><span id="LRCTree-236"><a href="#LRCTree-236"><span class="linenos">236</span></a>        <span class="k">if</span> <span class="n">parent_depth</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span><span class="p">:</span>
</span><span id="LRCTree-237"><a href="#LRCTree-237"><span class="linenos">237</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="LRCTree-238"><a href="#LRCTree-238"><span class="linenos">238</span></a>
</span><span id="LRCTree-239"><a href="#LRCTree-239"><span class="linenos">239</span></a>        <span class="n">highest_id</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="LRCTree-240"><a href="#LRCTree-240"><span class="linenos">240</span></a>
</span><span id="LRCTree-241"><a href="#LRCTree-241"><span class="linenos">241</span></a>        <span class="c1"># find the split information</span>
</span><span id="LRCTree-242"><a href="#LRCTree-242"><span class="linenos">242</span></a>        <span class="n">best_traditional_split</span> <span class="o">=</span> <span class="n">find_best_split</span><span class="p">(</span><span class="n">x_copy</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
</span><span id="LRCTree-243"><a href="#LRCTree-243"><span class="linenos">243</span></a>        <span class="n">best_lrct_split</span> <span class="o">=</span> <span class="n">find_best_lrct_split</span><span class="p">(</span>
</span><span id="LRCTree-244"><a href="#LRCTree-244"><span class="linenos">244</span></a>            <span class="n">x_copy</span><span class="p">,</span>
</span><span id="LRCTree-245"><a href="#LRCTree-245"><span class="linenos">245</span></a>            <span class="n">y_data</span><span class="p">,</span>
</span><span id="LRCTree-246"><a href="#LRCTree-246"><span class="linenos">246</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_independent</span><span class="p">,</span>
</span><span id="LRCTree-247"><a href="#LRCTree-247"><span class="linenos">247</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">highest_degree</span><span class="p">,</span>
</span><span id="LRCTree-248"><a href="#LRCTree-248"><span class="linenos">248</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">fit_intercepts</span><span class="p">,</span>
</span><span id="LRCTree-249"><a href="#LRCTree-249"><span class="linenos">249</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">,</span>
</span><span id="LRCTree-250"><a href="#LRCTree-250"><span class="linenos">250</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span><span class="p">,</span>
</span><span id="LRCTree-251"><a href="#LRCTree-251"><span class="linenos">251</span></a>            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span>
</span><span id="LRCTree-252"><a href="#LRCTree-252"><span class="linenos">252</span></a>        <span class="p">)</span>
</span><span id="LRCTree-253"><a href="#LRCTree-253"><span class="linenos">253</span></a>
</span><span id="LRCTree-254"><a href="#LRCTree-254"><span class="linenos">254</span></a>        <span class="k">if</span> <span class="n">best_traditional_split</span><span class="p">[</span><span class="s1">&#39;split_gini&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">best_lrct_split</span><span class="p">[</span><span class="s1">&#39;split_gini&#39;</span><span class="p">]:</span>
</span><span id="LRCTree-255"><a href="#LRCTree-255"><span class="linenos">255</span></a>            <span class="n">split</span> <span class="o">=</span> <span class="n">best_traditional_split</span>
</span><span id="LRCTree-256"><a href="#LRCTree-256"><span class="linenos">256</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LRCTree-257"><a href="#LRCTree-257"><span class="linenos">257</span></a>            <span class="n">split</span> <span class="o">=</span> <span class="n">best_lrct_split</span>
</span><span id="LRCTree-258"><a href="#LRCTree-258"><span class="linenos">258</span></a>
</span><span id="LRCTree-259"><a href="#LRCTree-259"><span class="linenos">259</span></a>        <span class="k">if</span> <span class="n">split</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col_idx&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LRCTree-260"><a href="#LRCTree-260"><span class="linenos">260</span></a>            <span class="n">less_idx</span> <span class="o">=</span> <span class="n">x_copy</span><span class="p">[:,</span> <span class="n">split</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col_idx&#39;</span><span class="p">)]</span> <span class="o">&lt;=</span> <span class="n">split</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_value&#39;</span><span class="p">)</span>
</span><span id="LRCTree-261"><a href="#LRCTree-261"><span class="linenos">261</span></a>            <span class="n">greater_idx</span> <span class="o">=</span> <span class="n">x_copy</span><span class="p">[:,</span> <span class="n">split</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col_idx&#39;</span><span class="p">)]</span> <span class="o">&gt;</span> <span class="n">split</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_value&#39;</span><span class="p">)</span>
</span><span id="LRCTree-262"><a href="#LRCTree-262"><span class="linenos">262</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LRCTree-263"><a href="#LRCTree-263"><span class="linenos">263</span></a>            <span class="n">ind</span> <span class="o">=</span> <span class="n">split</span><span class="p">[</span><span class="s1">&#39;indices&#39;</span><span class="p">]</span>
</span><span id="LRCTree-264"><a href="#LRCTree-264"><span class="linenos">264</span></a>            <span class="n">new_col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x_copy</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="LRCTree-265"><a href="#LRCTree-265"><span class="linenos">265</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">split</span><span class="p">[</span><span class="s1">&#39;coefs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="LRCTree-266"><a href="#LRCTree-266"><span class="linenos">266</span></a>                <span class="n">column_idx</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="LRCTree-267"><a href="#LRCTree-267"><span class="linenos">267</span></a>                <span class="n">power</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">//</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="LRCTree-268"><a href="#LRCTree-268"><span class="linenos">268</span></a>                <span class="n">new_col</span> <span class="o">+=</span> <span class="n">split</span><span class="p">[</span><span class="s1">&#39;coefs&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">x_copy</span><span class="p">[:,</span> <span class="n">column_idx</span><span class="p">]</span><span class="o">**</span><span class="n">power</span>
</span><span id="LRCTree-269"><a href="#LRCTree-269"><span class="linenos">269</span></a>            <span class="n">new_col</span> <span class="o">-=</span> <span class="n">x_copy</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="LRCTree-270"><a href="#LRCTree-270"><span class="linenos">270</span></a>            <span class="n">less_idx</span> <span class="o">=</span> <span class="n">new_col</span> <span class="o">&lt;=</span> <span class="n">split</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_value&#39;</span><span class="p">)</span>
</span><span id="LRCTree-271"><a href="#LRCTree-271"><span class="linenos">271</span></a>            <span class="n">greater_idx</span> <span class="o">=</span> <span class="n">new_col</span> <span class="o">&gt;</span> <span class="n">split</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;split_value&#39;</span><span class="p">)</span>
</span><span id="LRCTree-272"><a href="#LRCTree-272"><span class="linenos">272</span></a>
</span><span id="LRCTree-273"><a href="#LRCTree-273"><span class="linenos">273</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">less_idx</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_leaf</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">greater_idx</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_leaf</span><span class="p">):</span>
</span><span id="LRCTree-274"><a href="#LRCTree-274"><span class="linenos">274</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="LRCTree-275"><a href="#LRCTree-275"><span class="linenos">275</span></a>
</span><span id="LRCTree-276"><a href="#LRCTree-276"><span class="linenos">276</span></a>        <span class="n">less_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span>
</span><span id="LRCTree-277"><a href="#LRCTree-277"><span class="linenos">277</span></a>            <span class="n">highest_id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="LRCTree-278"><a href="#LRCTree-278"><span class="linenos">278</span></a>            <span class="n">parent_id</span><span class="p">,</span>
</span><span id="LRCTree-279"><a href="#LRCTree-279"><span class="linenos">279</span></a>            <span class="n">parent_depth</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="LRCTree-280"><a href="#LRCTree-280"><span class="linenos">280</span></a>        <span class="p">)</span>
</span><span id="LRCTree-281"><a href="#LRCTree-281"><span class="linenos">281</span></a>        <span class="n">greater_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span>
</span><span id="LRCTree-282"><a href="#LRCTree-282"><span class="linenos">282</span></a>            <span class="n">highest_id</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="LRCTree-283"><a href="#LRCTree-283"><span class="linenos">283</span></a>            <span class="n">parent_id</span><span class="p">,</span>
</span><span id="LRCTree-284"><a href="#LRCTree-284"><span class="linenos">284</span></a>            <span class="n">parent_depth</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="LRCTree-285"><a href="#LRCTree-285"><span class="linenos">285</span></a>        <span class="p">)</span>
</span><span id="LRCTree-286"><a href="#LRCTree-286"><span class="linenos">286</span></a>            
</span><span id="LRCTree-287"><a href="#LRCTree-287"><span class="linenos">287</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_add_nodes</span><span class="p">([</span><span class="n">less_node</span><span class="p">,</span> <span class="n">greater_node</span><span class="p">])</span>
</span><span id="LRCTree-288"><a href="#LRCTree-288"><span class="linenos">288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="n">parent_id</span><span class="p">]</span><span class="o">.</span><span class="n">split</span> <span class="o">=</span> <span class="n">split</span>
</span><span id="LRCTree-289"><a href="#LRCTree-289"><span class="linenos">289</span></a>        <span class="k">return</span> <span class="n">highest_id</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">highest_id</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x_copy</span><span class="p">[</span><span class="n">less_idx</span><span class="p">],</span> <span class="n">x_copy</span><span class="p">[</span><span class="n">greater_idx</span><span class="p">],</span> <span class="n">y_data</span><span class="p">[</span><span class="n">less_idx</span><span class="p">],</span> <span class="n">y_data</span><span class="p">[</span><span class="n">greater_idx</span><span class="p">]</span>
</span><span id="LRCTree-290"><a href="#LRCTree-290"><span class="linenos">290</span></a>
</span><span id="LRCTree-291"><a href="#LRCTree-291"><span class="linenos">291</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="LRCTree-292"><a href="#LRCTree-292"><span class="linenos">292</span></a>        <span class="sd">&quot;&quot;&quot;Fit the Tree</span>
</span><span id="LRCTree-293"><a href="#LRCTree-293"><span class="linenos">293</span></a>
</span><span id="LRCTree-294"><a href="#LRCTree-294"><span class="linenos">294</span></a><span class="sd">        Parameters</span>
</span><span id="LRCTree-295"><a href="#LRCTree-295"><span class="linenos">295</span></a><span class="sd">        ----------</span>
</span><span id="LRCTree-296"><a href="#LRCTree-296"><span class="linenos">296</span></a><span class="sd">        x : 2d array-like</span>
</span><span id="LRCTree-297"><a href="#LRCTree-297"><span class="linenos">297</span></a><span class="sd">            The independent data to learn from</span>
</span><span id="LRCTree-298"><a href="#LRCTree-298"><span class="linenos">298</span></a><span class="sd">        y : 1d numpy array or pandas Series</span>
</span><span id="LRCTree-299"><a href="#LRCTree-299"><span class="linenos">299</span></a><span class="sd">            The target to learn</span>
</span><span id="LRCTree-300"><a href="#LRCTree-300"><span class="linenos">300</span></a>
</span><span id="LRCTree-301"><a href="#LRCTree-301"><span class="linenos">301</span></a><span class="sd">        Returns</span>
</span><span id="LRCTree-302"><a href="#LRCTree-302"><span class="linenos">302</span></a><span class="sd">        -------</span>
</span><span id="LRCTree-303"><a href="#LRCTree-303"><span class="linenos">303</span></a><span class="sd">        tree : LRCTree</span>
</span><span id="LRCTree-304"><a href="#LRCTree-304"><span class="linenos">304</span></a><span class="sd">            The fit tree (self)</span>
</span><span id="LRCTree-305"><a href="#LRCTree-305"><span class="linenos">305</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LRCTree-306"><a href="#LRCTree-306"><span class="linenos">306</span></a>
</span><span id="LRCTree-307"><a href="#LRCTree-307"><span class="linenos">307</span></a>        <span class="c1"># typechecking</span>
</span><span id="LRCTree-308"><a href="#LRCTree-308"><span class="linenos">308</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
</span><span id="LRCTree-309"><a href="#LRCTree-309"><span class="linenos">309</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;x must be ndarray or pandas DataFrame&#39;</span><span class="p">)</span>
</span><span id="LRCTree-310"><a href="#LRCTree-310"><span class="linenos">310</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
</span><span id="LRCTree-311"><a href="#LRCTree-311"><span class="linenos">311</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;y must be ndarray or Series&#39;</span><span class="p">)</span>
</span><span id="LRCTree-312"><a href="#LRCTree-312"><span class="linenos">312</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="LRCTree-313"><a href="#LRCTree-313"><span class="linenos">313</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;y must have a single dimension&#39;</span><span class="p">)</span>
</span><span id="LRCTree-314"><a href="#LRCTree-314"><span class="linenos">314</span></a>
</span><span id="LRCTree-315"><a href="#LRCTree-315"><span class="linenos">315</span></a>        <span class="c1"># check the shapes of each variable</span>
</span><span id="LRCTree-316"><a href="#LRCTree-316"><span class="linenos">316</span></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="LRCTree-317"><a href="#LRCTree-317"><span class="linenos">317</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Number of records does not match number of samples&#39;</span><span class="p">)</span>
</span><span id="LRCTree-318"><a href="#LRCTree-318"><span class="linenos">318</span></a>
</span><span id="LRCTree-319"><a href="#LRCTree-319"><span class="linenos">319</span></a>        <span class="c1"># if y is pandas Series, use only values (numpy array)</span>
</span><span id="LRCTree-320"><a href="#LRCTree-320"><span class="linenos">320</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
</span><span id="LRCTree-321"><a href="#LRCTree-321"><span class="linenos">321</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">values</span>
</span><span id="LRCTree-322"><a href="#LRCTree-322"><span class="linenos">322</span></a>
</span><span id="LRCTree-323"><a href="#LRCTree-323"><span class="linenos">323</span></a>        <span class="c1"># instantiate the Nodes</span>
</span><span id="LRCTree-324"><a href="#LRCTree-324"><span class="linenos">324</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LRCTree-325"><a href="#LRCTree-325"><span class="linenos">325</span></a>
</span><span id="LRCTree-326"><a href="#LRCTree-326"><span class="linenos">326</span></a>        <span class="c1"># add the parent Node</span>
</span><span id="LRCTree-327"><a href="#LRCTree-327"><span class="linenos">327</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_add_nodes</span><span class="p">(</span><span class="n">Node</span><span class="p">())</span>
</span><span id="LRCTree-328"><a href="#LRCTree-328"><span class="linenos">328</span></a>
</span><span id="LRCTree-329"><a href="#LRCTree-329"><span class="linenos">329</span></a>        <span class="c1"># keep a record of all Node data for record keeping -- will be lost at the end however</span>
</span><span id="LRCTree-330"><a href="#LRCTree-330"><span class="linenos">330</span></a>        <span class="n">node_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LRCTree-331"><a href="#LRCTree-331"><span class="linenos">331</span></a>            <span class="mi">0</span><span class="p">:</span> <span class="p">{</span>
</span><span id="LRCTree-332"><a href="#LRCTree-332"><span class="linenos">332</span></a>                <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span>
</span><span id="LRCTree-333"><a href="#LRCTree-333"><span class="linenos">333</span></a>                <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span>
</span><span id="LRCTree-334"><a href="#LRCTree-334"><span class="linenos">334</span></a>            <span class="p">}</span>
</span><span id="LRCTree-335"><a href="#LRCTree-335"><span class="linenos">335</span></a>        <span class="p">}</span>
</span><span id="LRCTree-336"><a href="#LRCTree-336"><span class="linenos">336</span></a>
</span><span id="LRCTree-337"><a href="#LRCTree-337"><span class="linenos">337</span></a>        <span class="c1"># fitting logic is inside while loop</span>
</span><span id="LRCTree-338"><a href="#LRCTree-338"><span class="linenos">338</span></a>        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span><span class="p">:</span>
</span><span id="LRCTree-339"><a href="#LRCTree-339"><span class="linenos">339</span></a>
</span><span id="LRCTree-340"><a href="#LRCTree-340"><span class="linenos">340</span></a>            <span class="c1"># record current depth Nodes and how many Nodes exist to determine stopping criteria later</span>
</span><span id="LRCTree-341"><a href="#LRCTree-341"><span class="linenos">341</span></a>            <span class="n">current_depth_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">depth</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">]</span>
</span><span id="LRCTree-342"><a href="#LRCTree-342"><span class="linenos">342</span></a>            <span class="n">num_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
</span><span id="LRCTree-343"><a href="#LRCTree-343"><span class="linenos">343</span></a>
</span><span id="LRCTree-344"><a href="#LRCTree-344"><span class="linenos">344</span></a>            <span class="c1"># try to split all of the current depth Nodes</span>
</span><span id="LRCTree-345"><a href="#LRCTree-345"><span class="linenos">345</span></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">current_depth_nodes</span><span class="p">:</span>
</span><span id="LRCTree-346"><a href="#LRCTree-346"><span class="linenos">346</span></a>                <span class="n">split_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_split_node</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span><span class="p">,</span> <span class="n">node_data</span><span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
</span><span id="LRCTree-347"><a href="#LRCTree-347"><span class="linenos">347</span></a>                                                 <span class="n">node_data</span><span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
</span><span id="LRCTree-348"><a href="#LRCTree-348"><span class="linenos">348</span></a>
</span><span id="LRCTree-349"><a href="#LRCTree-349"><span class="linenos">349</span></a>                <span class="c1"># get the split information if there is an actual split to get</span>
</span><span id="LRCTree-350"><a href="#LRCTree-350"><span class="linenos">350</span></a>                <span class="c1"># remember -- if split_results is not None, the Node was actually split and new Nodes were added to the</span>
</span><span id="LRCTree-351"><a href="#LRCTree-351"><span class="linenos">351</span></a>                <span class="c1"># Tree</span>
</span><span id="LRCTree-352"><a href="#LRCTree-352"><span class="linenos">352</span></a>                <span class="k">if</span> <span class="n">split_results</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LRCTree-353"><a href="#LRCTree-353"><span class="linenos">353</span></a>                    <span class="c1"># get the data for each side</span>
</span><span id="LRCTree-354"><a href="#LRCTree-354"><span class="linenos">354</span></a>                    <span class="n">less_id</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="LRCTree-355"><a href="#LRCTree-355"><span class="linenos">355</span></a>                    <span class="n">greater_id</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LRCTree-356"><a href="#LRCTree-356"><span class="linenos">356</span></a>                    <span class="n">x_less</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="LRCTree-357"><a href="#LRCTree-357"><span class="linenos">357</span></a>                    <span class="n">x_greater</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="LRCTree-358"><a href="#LRCTree-358"><span class="linenos">358</span></a>                    <span class="n">y_less</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</span><span id="LRCTree-359"><a href="#LRCTree-359"><span class="linenos">359</span></a>                    <span class="n">y_greater</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</span><span id="LRCTree-360"><a href="#LRCTree-360"><span class="linenos">360</span></a>
</span><span id="LRCTree-361"><a href="#LRCTree-361"><span class="linenos">361</span></a>                    <span class="c1"># create the Nodes</span>
</span><span id="LRCTree-362"><a href="#LRCTree-362"><span class="linenos">362</span></a>                    <span class="n">node_data</span><span class="p">[</span><span class="n">less_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LRCTree-363"><a href="#LRCTree-363"><span class="linenos">363</span></a>                        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x_less</span><span class="p">,</span>
</span><span id="LRCTree-364"><a href="#LRCTree-364"><span class="linenos">364</span></a>                        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y_less</span>
</span><span id="LRCTree-365"><a href="#LRCTree-365"><span class="linenos">365</span></a>                    <span class="p">}</span>
</span><span id="LRCTree-366"><a href="#LRCTree-366"><span class="linenos">366</span></a>                    <span class="n">node_data</span><span class="p">[</span><span class="n">greater_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LRCTree-367"><a href="#LRCTree-367"><span class="linenos">367</span></a>                        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x_greater</span><span class="p">,</span>
</span><span id="LRCTree-368"><a href="#LRCTree-368"><span class="linenos">368</span></a>                        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y_greater</span>
</span><span id="LRCTree-369"><a href="#LRCTree-369"><span class="linenos">369</span></a>                    <span class="p">}</span>
</span><span id="LRCTree-370"><a href="#LRCTree-370"><span class="linenos">370</span></a>
</span><span id="LRCTree-371"><a href="#LRCTree-371"><span class="linenos">371</span></a>            <span class="c1"># if no new Nodes, then we are done</span>
</span><span id="LRCTree-372"><a href="#LRCTree-372"><span class="linenos">372</span></a>            <span class="n">new_num_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
</span><span id="LRCTree-373"><a href="#LRCTree-373"><span class="linenos">373</span></a>            <span class="k">if</span> <span class="n">new_num_nodes</span> <span class="o">==</span> <span class="n">num_nodes</span><span class="p">:</span>
</span><span id="LRCTree-374"><a href="#LRCTree-374"><span class="linenos">374</span></a>                <span class="k">break</span>
</span><span id="LRCTree-375"><a href="#LRCTree-375"><span class="linenos">375</span></a>
</span><span id="LRCTree-376"><a href="#LRCTree-376"><span class="linenos">376</span></a>        <span class="c1"># set _is_fit to True</span>
</span><span id="LRCTree-377"><a href="#LRCTree-377"><span class="linenos">377</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_is_fit</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LRCTree-378"><a href="#LRCTree-378"><span class="linenos">378</span></a>
</span><span id="LRCTree-379"><a href="#LRCTree-379"><span class="linenos">379</span></a>        <span class="c1"># _values_to_predict helps with predicting probabilities</span>
</span><span id="LRCTree-380"><a href="#LRCTree-380"><span class="linenos">380</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">values_to_predict_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="LRCTree-381"><a href="#LRCTree-381"><span class="linenos">381</span></a>
</span><span id="LRCTree-382"><a href="#LRCTree-382"><span class="linenos">382</span></a>        <span class="c1"># _node_distributions helps with predicting</span>
</span><span id="LRCTree-383"><a href="#LRCTree-383"><span class="linenos">383</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">node_distributions_</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LRCTree-384"><a href="#LRCTree-384"><span class="linenos">384</span></a>            <span class="n">n</span><span class="o">.</span><span class="n">identifier</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">node_data</span><span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values_to_predict_</span><span class="p">])</span>
</span><span id="LRCTree-385"><a href="#LRCTree-385"><span class="linenos">385</span></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">split</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="LRCTree-386"><a href="#LRCTree-386"><span class="linenos">386</span></a>        <span class="p">}</span>
</span><span id="LRCTree-387"><a href="#LRCTree-387"><span class="linenos">387</span></a>
</span><span id="LRCTree-388"><a href="#LRCTree-388"><span class="linenos">388</span></a>        <span class="c1"># return self for consistency with scikit-learn</span>
</span><span id="LRCTree-389"><a href="#LRCTree-389"><span class="linenos">389</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span><span id="LRCTree-390"><a href="#LRCTree-390"><span class="linenos">390</span></a>
</span><span id="LRCTree-391"><a href="#LRCTree-391"><span class="linenos">391</span></a>    <span class="k">def</span> <span class="nf">_predict_single_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">proba</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="LRCTree-392"><a href="#LRCTree-392"><span class="linenos">392</span></a>        <span class="sd">&quot;&quot;&quot;Predict a single new instance</span>
</span><span id="LRCTree-393"><a href="#LRCTree-393"><span class="linenos">393</span></a>
</span><span id="LRCTree-394"><a href="#LRCTree-394"><span class="linenos">394</span></a><span class="sd">        Parameters</span>
</span><span id="LRCTree-395"><a href="#LRCTree-395"><span class="linenos">395</span></a><span class="sd">        ----------</span>
</span><span id="LRCTree-396"><a href="#LRCTree-396"><span class="linenos">396</span></a><span class="sd">        instance : 1d numpy array</span>
</span><span id="LRCTree-397"><a href="#LRCTree-397"><span class="linenos">397</span></a><span class="sd">            Object which has the desired implementation of the .keys() method</span>
</span><span id="LRCTree-398"><a href="#LRCTree-398"><span class="linenos">398</span></a><span class="sd">        proba : bool (default False)</span>
</span><span id="LRCTree-399"><a href="#LRCTree-399"><span class="linenos">399</span></a><span class="sd">            Whether to return probabilities</span>
</span><span id="LRCTree-400"><a href="#LRCTree-400"><span class="linenos">400</span></a>
</span><span id="LRCTree-401"><a href="#LRCTree-401"><span class="linenos">401</span></a><span class="sd">        Returns</span>
</span><span id="LRCTree-402"><a href="#LRCTree-402"><span class="linenos">402</span></a><span class="sd">        -------</span>
</span><span id="LRCTree-403"><a href="#LRCTree-403"><span class="linenos">403</span></a><span class="sd">        prediction : int or float</span>
</span><span id="LRCTree-404"><a href="#LRCTree-404"><span class="linenos">404</span></a><span class="sd">            The class predicted or probabilities predicted</span>
</span><span id="LRCTree-405"><a href="#LRCTree-405"><span class="linenos">405</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LRCTree-406"><a href="#LRCTree-406"><span class="linenos">406</span></a>
</span><span id="LRCTree-407"><a href="#LRCTree-407"><span class="linenos">407</span></a>        <span class="c1"># start at the root Node</span>
</span><span id="LRCTree-408"><a href="#LRCTree-408"><span class="linenos">408</span></a>        <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="LRCTree-409"><a href="#LRCTree-409"><span class="linenos">409</span></a>
</span><span id="LRCTree-410"><a href="#LRCTree-410"><span class="linenos">410</span></a>        <span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="LRCTree-411"><a href="#LRCTree-411"><span class="linenos">411</span></a>            <span class="n">child_node_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">parent_id</span> <span class="o">==</span> <span class="n">current_node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span>
</span><span id="LRCTree-412"><a href="#LRCTree-412"><span class="linenos">412</span></a>            <span class="k">if</span> <span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;col_idx&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LRCTree-413"><a href="#LRCTree-413"><span class="linenos">413</span></a>                <span class="k">if</span> <span class="n">instance</span><span class="p">[</span><span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="s1">&#39;col_idx&#39;</span><span class="p">]]</span> <span class="o">&lt;=</span> <span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="s1">&#39;split_value&#39;</span><span class="p">]:</span>
</span><span id="LRCTree-414"><a href="#LRCTree-414"><span class="linenos">414</span></a>                    <span class="n">new_node_id</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">child_node_ids</span><span class="p">)</span>
</span><span id="LRCTree-415"><a href="#LRCTree-415"><span class="linenos">415</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="LRCTree-416"><a href="#LRCTree-416"><span class="linenos">416</span></a>                    <span class="n">new_node_id</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">child_node_ids</span><span class="p">)</span>
</span><span id="LRCTree-417"><a href="#LRCTree-417"><span class="linenos">417</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="LRCTree-418"><a href="#LRCTree-418"><span class="linenos">418</span></a>                <span class="n">ind</span> <span class="o">=</span> <span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="s1">&#39;indices&#39;</span><span class="p">]</span>
</span><span id="LRCTree-419"><a href="#LRCTree-419"><span class="linenos">419</span></a>                <span class="n">new_val</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="LRCTree-420"><a href="#LRCTree-420"><span class="linenos">420</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="s1">&#39;coefs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
</span><span id="LRCTree-421"><a href="#LRCTree-421"><span class="linenos">421</span></a>                    <span class="n">column_index</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
</span><span id="LRCTree-422"><a href="#LRCTree-422"><span class="linenos">422</span></a>                    <span class="n">power</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">//</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="LRCTree-423"><a href="#LRCTree-423"><span class="linenos">423</span></a>                    <span class="n">new_val</span> <span class="o">+=</span> <span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="s1">&#39;coefs&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">instance</span><span class="p">[</span><span class="n">column_index</span><span class="p">]</span><span class="o">**</span><span class="n">power</span>
</span><span id="LRCTree-424"><a href="#LRCTree-424"><span class="linenos">424</span></a>                <span class="n">new_val</span> <span class="o">-=</span> <span class="n">instance</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="LRCTree-425"><a href="#LRCTree-425"><span class="linenos">425</span></a>                <span class="k">if</span> <span class="n">new_val</span> <span class="o">&lt;=</span> <span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="p">[</span><span class="s1">&#39;split_value&#39;</span><span class="p">]:</span>
</span><span id="LRCTree-426"><a href="#LRCTree-426"><span class="linenos">426</span></a>                    <span class="n">new_node_id</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">child_node_ids</span><span class="p">)</span>
</span><span id="LRCTree-427"><a href="#LRCTree-427"><span class="linenos">427</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="LRCTree-428"><a href="#LRCTree-428"><span class="linenos">428</span></a>                    <span class="n">new_node_id</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">child_node_ids</span><span class="p">)</span>
</span><span id="LRCTree-429"><a href="#LRCTree-429"><span class="linenos">429</span></a>            
</span><span id="LRCTree-430"><a href="#LRCTree-430"><span class="linenos">430</span></a>            <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="n">new_node_id</span><span class="p">]</span>
</span><span id="LRCTree-431"><a href="#LRCTree-431"><span class="linenos">431</span></a>        
</span><span id="LRCTree-432"><a href="#LRCTree-432"><span class="linenos">432</span></a>        <span class="c1"># after we&#39;re out of the while loop, get the current distribution to see what we need to predict</span>
</span><span id="LRCTree-433"><a href="#LRCTree-433"><span class="linenos">433</span></a>        <span class="n">current_distribution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_distributions_</span><span class="p">[</span><span class="n">current_node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span>
</span><span id="LRCTree-434"><a href="#LRCTree-434"><span class="linenos">434</span></a>
</span><span id="LRCTree-435"><a href="#LRCTree-435"><span class="linenos">435</span></a>        <span class="c1"># get the probabilities</span>
</span><span id="LRCTree-436"><a href="#LRCTree-436"><span class="linenos">436</span></a>        <span class="n">probabilities</span> <span class="o">=</span> <span class="n">current_distribution</span> <span class="o">/</span> <span class="n">current_distribution</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="LRCTree-437"><a href="#LRCTree-437"><span class="linenos">437</span></a>        
</span><span id="LRCTree-438"><a href="#LRCTree-438"><span class="linenos">438</span></a>        <span class="c1"># return probabilities if asked for</span>
</span><span id="LRCTree-439"><a href="#LRCTree-439"><span class="linenos">439</span></a>        <span class="k">if</span> <span class="n">proba</span><span class="p">:</span>
</span><span id="LRCTree-440"><a href="#LRCTree-440"><span class="linenos">440</span></a>            <span class="k">return</span> <span class="n">probabilities</span>
</span><span id="LRCTree-441"><a href="#LRCTree-441"><span class="linenos">441</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LRCTree-442"><a href="#LRCTree-442"><span class="linenos">442</span></a>            <span class="c1"># check if there&#39;s a clear winner</span>
</span><span id="LRCTree-443"><a href="#LRCTree-443"><span class="linenos">443</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">probabilities</span> <span class="o">==</span> <span class="n">probabilities</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="LRCTree-444"><a href="#LRCTree-444"><span class="linenos">444</span></a>                <span class="k">return</span> <span class="n">probabilities</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>
</span><span id="LRCTree-445"><a href="#LRCTree-445"><span class="linenos">445</span></a>            
</span><span id="LRCTree-446"><a href="#LRCTree-446"><span class="linenos">446</span></a>            <span class="c1"># if there&#39;s no clear winner, return a random guess from the most common ones</span>
</span><span id="LRCTree-447"><a href="#LRCTree-447"><span class="linenos">447</span></a>            <span class="n">highest_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">probabilities</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">probabilities</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">probabilities</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>
</span><span id="LRCTree-448"><a href="#LRCTree-448"><span class="linenos">448</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">highest_indices</span><span class="p">)</span>
</span><span id="LRCTree-449"><a href="#LRCTree-449"><span class="linenos">449</span></a>            
</span><span id="LRCTree-450"><a href="#LRCTree-450"><span class="linenos">450</span></a>    <span class="k">def</span> <span class="nf">_predict_single_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
</span><span id="LRCTree-451"><a href="#LRCTree-451"><span class="linenos">451</span></a>        <span class="sd">&quot;&quot;&quot;Predict class probabilities for a single instance</span>
</span><span id="LRCTree-452"><a href="#LRCTree-452"><span class="linenos">452</span></a>
</span><span id="LRCTree-453"><a href="#LRCTree-453"><span class="linenos">453</span></a><span class="sd">        Parameters</span>
</span><span id="LRCTree-454"><a href="#LRCTree-454"><span class="linenos">454</span></a><span class="sd">        ----------</span>
</span><span id="LRCTree-455"><a href="#LRCTree-455"><span class="linenos">455</span></a><span class="sd">        instance : pd.Series or dict</span>
</span><span id="LRCTree-456"><a href="#LRCTree-456"><span class="linenos">456</span></a><span class="sd">            Object which has the desired implementation of the .keys() method</span>
</span><span id="LRCTree-457"><a href="#LRCTree-457"><span class="linenos">457</span></a>
</span><span id="LRCTree-458"><a href="#LRCTree-458"><span class="linenos">458</span></a><span class="sd">        Returns</span>
</span><span id="LRCTree-459"><a href="#LRCTree-459"><span class="linenos">459</span></a><span class="sd">        -------</span>
</span><span id="LRCTree-460"><a href="#LRCTree-460"><span class="linenos">460</span></a><span class="sd">        probas : numpy array</span>
</span><span id="LRCTree-461"><a href="#LRCTree-461"><span class="linenos">461</span></a><span class="sd">            Array of shape (n_classes,), where n_classes is the number of classes trained on</span>
</span><span id="LRCTree-462"><a href="#LRCTree-462"><span class="linenos">462</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LRCTree-463"><a href="#LRCTree-463"><span class="linenos">463</span></a>
</span><span id="LRCTree-464"><a href="#LRCTree-464"><span class="linenos">464</span></a>        <span class="c1"># implementation of this function is similar to the implementation of _predict_single_instance</span>
</span><span id="LRCTree-465"><a href="#LRCTree-465"><span class="linenos">465</span></a>        <span class="c1"># except return the node distributions normalized to sum to 1</span>
</span><span id="LRCTree-466"><a href="#LRCTree-466"><span class="linenos">466</span></a>        <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="LRCTree-467"><a href="#LRCTree-467"><span class="linenos">467</span></a>
</span><span id="LRCTree-468"><a href="#LRCTree-468"><span class="linenos">468</span></a>        <span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">current_node</span><span class="o">.</span><span class="n">split</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
</span><span id="LRCTree-469"><a href="#LRCTree-469"><span class="linenos">469</span></a>            <span class="n">child_node_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">parent_id</span> <span class="o">==</span> <span class="n">current_node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span>
</span><span id="LRCTree-470"><a href="#LRCTree-470"><span class="linenos">470</span></a>            <span class="n">split_col</span><span class="p">,</span> <span class="n">split_value</span> <span class="o">=</span> <span class="n">current_node</span><span class="o">.</span><span class="n">split</span>
</span><span id="LRCTree-471"><a href="#LRCTree-471"><span class="linenos">471</span></a>            <span class="k">if</span> <span class="n">split_col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="LRCTree-472"><a href="#LRCTree-472"><span class="linenos">472</span></a>                <span class="n">rest</span><span class="p">,</span> <span class="n">last_col</span> <span class="o">=</span> <span class="n">split_col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; - &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">split_col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; - &#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LRCTree-473"><a href="#LRCTree-473"><span class="linenos">473</span></a>                <span class="n">new_coefs</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">rest</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; + &#39;</span><span class="p">)]</span>
</span><span id="LRCTree-474"><a href="#LRCTree-474"><span class="linenos">474</span></a>                <span class="n">new_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;^&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">rest</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; + &#39;</span><span class="p">)]</span>
</span><span id="LRCTree-475"><a href="#LRCTree-475"><span class="linenos">475</span></a>                <span class="n">new_col_components</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="LRCTree-476"><a href="#LRCTree-476"><span class="linenos">476</span></a>                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_coefs</span><span class="p">)):</span>
</span><span id="LRCTree-477"><a href="#LRCTree-477"><span class="linenos">477</span></a>                    <span class="k">if</span> <span class="s1">&#39;^&#39;</span> <span class="ow">in</span> <span class="n">new_cols</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="LRCTree-478"><a href="#LRCTree-478"><span class="linenos">478</span></a>                        <span class="n">col</span><span class="p">,</span> <span class="n">exp</span> <span class="o">=</span> <span class="n">new_cols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;^&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">new_cols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;^&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LRCTree-479"><a href="#LRCTree-479"><span class="linenos">479</span></a>                        <span class="n">new_col_components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">new_coefs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">*instance[&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&quot;]**</span><span class="si">{</span><span class="n">exp</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="LRCTree-480"><a href="#LRCTree-480"><span class="linenos">480</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="LRCTree-481"><a href="#LRCTree-481"><span class="linenos">481</span></a>                        <span class="n">new_col_components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">new_coefs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">*instance[&quot;</span><span class="si">{</span><span class="n">new_cols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot;]&#39;</span><span class="p">)</span>
</span><span id="LRCTree-482"><a href="#LRCTree-482"><span class="linenos">482</span></a>                <span class="n">new_col_str</span> <span class="o">=</span> <span class="s1">&#39; + &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_col_components</span><span class="p">)</span>
</span><span id="LRCTree-483"><a href="#LRCTree-483"><span class="linenos">483</span></a>                <span class="n">new_col_str</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39; - instance[&quot;</span><span class="si">{</span><span class="n">last_col</span><span class="si">}</span><span class="s1">&quot;]&#39;</span>
</span><span id="LRCTree-484"><a href="#LRCTree-484"><span class="linenos">484</span></a>                <span class="n">val_to_check</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">new_col_str</span><span class="p">)</span>
</span><span id="LRCTree-485"><a href="#LRCTree-485"><span class="linenos">485</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="LRCTree-486"><a href="#LRCTree-486"><span class="linenos">486</span></a>                <span class="n">val_to_check</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="n">split_col</span><span class="p">]</span>
</span><span id="LRCTree-487"><a href="#LRCTree-487"><span class="linenos">487</span></a>
</span><span id="LRCTree-488"><a href="#LRCTree-488"><span class="linenos">488</span></a>            <span class="k">if</span> <span class="n">val_to_check</span> <span class="o">&lt;=</span> <span class="n">split_value</span><span class="p">:</span>
</span><span id="LRCTree-489"><a href="#LRCTree-489"><span class="linenos">489</span></a>                <span class="n">new_node_id</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">child_node_ids</span><span class="p">)</span>
</span><span id="LRCTree-490"><a href="#LRCTree-490"><span class="linenos">490</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="LRCTree-491"><a href="#LRCTree-491"><span class="linenos">491</span></a>                <span class="n">new_node_id</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">child_node_ids</span><span class="p">)</span>
</span><span id="LRCTree-492"><a href="#LRCTree-492"><span class="linenos">492</span></a>            <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="n">new_node_id</span><span class="p">]</span>
</span><span id="LRCTree-493"><a href="#LRCTree-493"><span class="linenos">493</span></a>
</span><span id="LRCTree-494"><a href="#LRCTree-494"><span class="linenos">494</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_distributions_</span><span class="p">[</span><span class="n">current_node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_distributions_</span><span class="p">[</span>
</span><span id="LRCTree-495"><a href="#LRCTree-495"><span class="linenos">495</span></a>            <span class="n">current_node</span><span class="o">.</span><span class="n">identifier</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="LRCTree-496"><a href="#LRCTree-496"><span class="linenos">496</span></a>
</span><span id="LRCTree-497"><a href="#LRCTree-497"><span class="linenos">497</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="LRCTree-498"><a href="#LRCTree-498"><span class="linenos">498</span></a>        <span class="sd">&quot;&quot;&quot;Predict classes for a set of values</span>
</span><span id="LRCTree-499"><a href="#LRCTree-499"><span class="linenos">499</span></a>
</span><span id="LRCTree-500"><a href="#LRCTree-500"><span class="linenos">500</span></a><span class="sd">        Parameters</span>
</span><span id="LRCTree-501"><a href="#LRCTree-501"><span class="linenos">501</span></a><span class="sd">        ----------</span>
</span><span id="LRCTree-502"><a href="#LRCTree-502"><span class="linenos">502</span></a><span class="sd">        x : pandas DataFrame</span>
</span><span id="LRCTree-503"><a href="#LRCTree-503"><span class="linenos">503</span></a><span class="sd">            Data to predict from</span>
</span><span id="LRCTree-504"><a href="#LRCTree-504"><span class="linenos">504</span></a>
</span><span id="LRCTree-505"><a href="#LRCTree-505"><span class="linenos">505</span></a><span class="sd">        Returns</span>
</span><span id="LRCTree-506"><a href="#LRCTree-506"><span class="linenos">506</span></a><span class="sd">        -------</span>
</span><span id="LRCTree-507"><a href="#LRCTree-507"><span class="linenos">507</span></a><span class="sd">        preds : numpy array</span>
</span><span id="LRCTree-508"><a href="#LRCTree-508"><span class="linenos">508</span></a><span class="sd">            Numpy array of predictions</span>
</span><span id="LRCTree-509"><a href="#LRCTree-509"><span class="linenos">509</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LRCTree-510"><a href="#LRCTree-510"><span class="linenos">510</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_fit</span><span class="p">:</span>
</span><span id="LRCTree-511"><a href="#LRCTree-511"><span class="linenos">511</span></a>            <span class="k">raise</span> <span class="n">NotFitError</span>
</span><span id="LRCTree-512"><a href="#LRCTree-512"><span class="linenos">512</span></a>
</span><span id="LRCTree-513"><a href="#LRCTree-513"><span class="linenos">513</span></a>        <span class="c1"># this function just applies the _predict_single_instance method to each of the rows</span>
</span><span id="LRCTree-514"><a href="#LRCTree-514"><span class="linenos">514</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_single_instance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">proba</span> <span class="o">=</span> <span class="kc">False</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="LRCTree-515"><a href="#LRCTree-515"><span class="linenos">515</span></a>
</span><span id="LRCTree-516"><a href="#LRCTree-516"><span class="linenos">516</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="LRCTree-517"><a href="#LRCTree-517"><span class="linenos">517</span></a>        <span class="sd">&quot;&quot;&quot;Predict class probabilities for a set of values</span>
</span><span id="LRCTree-518"><a href="#LRCTree-518"><span class="linenos">518</span></a>
</span><span id="LRCTree-519"><a href="#LRCTree-519"><span class="linenos">519</span></a><span class="sd">        Parameters</span>
</span><span id="LRCTree-520"><a href="#LRCTree-520"><span class="linenos">520</span></a><span class="sd">        ----------</span>
</span><span id="LRCTree-521"><a href="#LRCTree-521"><span class="linenos">521</span></a><span class="sd">        x : 2d array-like</span>
</span><span id="LRCTree-522"><a href="#LRCTree-522"><span class="linenos">522</span></a><span class="sd">            Data to predict from</span>
</span><span id="LRCTree-523"><a href="#LRCTree-523"><span class="linenos">523</span></a>
</span><span id="LRCTree-524"><a href="#LRCTree-524"><span class="linenos">524</span></a><span class="sd">        Returns</span>
</span><span id="LRCTree-525"><a href="#LRCTree-525"><span class="linenos">525</span></a><span class="sd">        -------</span>
</span><span id="LRCTree-526"><a href="#LRCTree-526"><span class="linenos">526</span></a><span class="sd">        preds : numpy array</span>
</span><span id="LRCTree-527"><a href="#LRCTree-527"><span class="linenos">527</span></a><span class="sd">            Numpy array of predicted probabilities. Column indices correspond to same classes</span>
</span><span id="LRCTree-528"><a href="#LRCTree-528"><span class="linenos">528</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LRCTree-529"><a href="#LRCTree-529"><span class="linenos">529</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_fit</span><span class="p">:</span>
</span><span id="LRCTree-530"><a href="#LRCTree-530"><span class="linenos">530</span></a>            <span class="k">raise</span> <span class="n">NotFitError</span>
</span><span id="LRCTree-531"><a href="#LRCTree-531"><span class="linenos">531</span></a>
</span><span id="LRCTree-532"><a href="#LRCTree-532"><span class="linenos">532</span></a>        <span class="c1"># apply predicting with probabilities</span>
</span><span id="LRCTree-533"><a href="#LRCTree-533"><span class="linenos">533</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_single_instance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">proba</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span><span id="LRCTree-534"><a href="#LRCTree-534"><span class="linenos">534</span></a>
</span><span id="LRCTree-535"><a href="#LRCTree-535"><span class="linenos">535</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="LRCTree-536"><a href="#LRCTree-536"><span class="linenos">536</span></a>        <span class="sd">&quot;&quot;&quot;Score the model&#39;s performance on new labeled data using accuracy score as a measure</span>
</span><span id="LRCTree-537"><a href="#LRCTree-537"><span class="linenos">537</span></a>
</span><span id="LRCTree-538"><a href="#LRCTree-538"><span class="linenos">538</span></a><span class="sd">        Parameters</span>
</span><span id="LRCTree-539"><a href="#LRCTree-539"><span class="linenos">539</span></a><span class="sd">        ----------</span>
</span><span id="LRCTree-540"><a href="#LRCTree-540"><span class="linenos">540</span></a><span class="sd">        x : pandas DataFrame</span>
</span><span id="LRCTree-541"><a href="#LRCTree-541"><span class="linenos">541</span></a><span class="sd">            DataFrame to predict from</span>
</span><span id="LRCTree-542"><a href="#LRCTree-542"><span class="linenos">542</span></a><span class="sd">        y : pandas Series or 1d numpy array</span>
</span><span id="LRCTree-543"><a href="#LRCTree-543"><span class="linenos">543</span></a><span class="sd">            Labels for data</span>
</span><span id="LRCTree-544"><a href="#LRCTree-544"><span class="linenos">544</span></a>
</span><span id="LRCTree-545"><a href="#LRCTree-545"><span class="linenos">545</span></a><span class="sd">        Returns</span>
</span><span id="LRCTree-546"><a href="#LRCTree-546"><span class="linenos">546</span></a><span class="sd">        -------</span>
</span><span id="LRCTree-547"><a href="#LRCTree-547"><span class="linenos">547</span></a><span class="sd">        score : float</span>
</span><span id="LRCTree-548"><a href="#LRCTree-548"><span class="linenos">548</span></a><span class="sd">            Accuracy score of the model on its predictions of x</span>
</span><span id="LRCTree-549"><a href="#LRCTree-549"><span class="linenos">549</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LRCTree-550"><a href="#LRCTree-550"><span class="linenos">550</span></a>        <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="LRCTree-551"><a href="#LRCTree-551"><span class="linenos">551</span></a>        <span class="k">return</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>
</span><span id="LRCTree-552"><a href="#LRCTree-552"><span class="linenos">552</span></a>
</span><span id="LRCTree-553"><a href="#LRCTree-553"><span class="linenos">553</span></a>    <span class="k">def</span> <span class="nf">fit_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="LRCTree-554"><a href="#LRCTree-554"><span class="linenos">554</span></a>        <span class="sd">&quot;&quot;&quot;Fit the model and predict on X</span>
</span><span id="LRCTree-555"><a href="#LRCTree-555"><span class="linenos">555</span></a>
</span><span id="LRCTree-556"><a href="#LRCTree-556"><span class="linenos">556</span></a><span class="sd">        Parameters</span>
</span><span id="LRCTree-557"><a href="#LRCTree-557"><span class="linenos">557</span></a><span class="sd">        ----------</span>
</span><span id="LRCTree-558"><a href="#LRCTree-558"><span class="linenos">558</span></a><span class="sd">        x : pandas DataFrame</span>
</span><span id="LRCTree-559"><a href="#LRCTree-559"><span class="linenos">559</span></a><span class="sd">            DataFrame to train on and predict from</span>
</span><span id="LRCTree-560"><a href="#LRCTree-560"><span class="linenos">560</span></a><span class="sd">        y : pandas Series or 1d numpy array</span>
</span><span id="LRCTree-561"><a href="#LRCTree-561"><span class="linenos">561</span></a><span class="sd">            Labels for x to learn from</span>
</span><span id="LRCTree-562"><a href="#LRCTree-562"><span class="linenos">562</span></a>
</span><span id="LRCTree-563"><a href="#LRCTree-563"><span class="linenos">563</span></a><span class="sd">        Returns</span>
</span><span id="LRCTree-564"><a href="#LRCTree-564"><span class="linenos">564</span></a><span class="sd">        -------</span>
</span><span id="LRCTree-565"><a href="#LRCTree-565"><span class="linenos">565</span></a><span class="sd">        preds : 1d numpy array</span>
</span><span id="LRCTree-566"><a href="#LRCTree-566"><span class="linenos">566</span></a><span class="sd">            Predictions on x after fitting</span>
</span><span id="LRCTree-567"><a href="#LRCTree-567"><span class="linenos">567</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LRCTree-568"><a href="#LRCTree-568"><span class="linenos">568</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="LRCTree-569"><a href="#LRCTree-569"><span class="linenos">569</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Linear Regression Classification Tree</p>

<p>LRCT serves as an improved classification tree capable of making multivariate
linear and nonlinear splits in its training.  It does this by approximating the
optimal surface function across multiple variables by applying binning and linear
regression.</p>
</div>


                            <div id="LRCTree.__init__" class="classattr">
                                        <input id="LRCTree.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">LRCTree</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">min_samples_split</span><span class="o">=</span><span class="mi">2</span>,</span><span class="param">	<span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">1</span>,</span><span class="param">	<span class="n">n_independent</span><span class="o">=</span><span class="mi">1</span>,</span><span class="param">	<span class="n">highest_degree</span><span class="o">=</span><span class="mi">1</span>,</span><span class="param">	<span class="n">fit_intercepts</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">method</span><span class="o">=</span><span class="s1">&#39;ols&#39;</span>,</span><span class="param">	<span class="n">n_bins</span><span class="o">=</span><span class="mi">10</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="LRCTree.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LRCTree.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LRCTree.__init__-21"><a href="#LRCTree.__init__-21"><span class="linenos">21</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="LRCTree.__init__-22"><a href="#LRCTree.__init__-22"><span class="linenos">22</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="LRCTree.__init__-23"><a href="#LRCTree.__init__-23"><span class="linenos">23</span></a>            <span class="n">max_depth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="LRCTree.__init__-24"><a href="#LRCTree.__init__-24"><span class="linenos">24</span></a>            <span class="n">min_samples_split</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="LRCTree.__init__-25"><a href="#LRCTree.__init__-25"><span class="linenos">25</span></a>            <span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LRCTree.__init__-26"><a href="#LRCTree.__init__-26"><span class="linenos">26</span></a>            <span class="n">n_independent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LRCTree.__init__-27"><a href="#LRCTree.__init__-27"><span class="linenos">27</span></a>            <span class="n">highest_degree</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="LRCTree.__init__-28"><a href="#LRCTree.__init__-28"><span class="linenos">28</span></a>            <span class="n">fit_intercepts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="LRCTree.__init__-29"><a href="#LRCTree.__init__-29"><span class="linenos">29</span></a>            <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ols&#39;</span><span class="p">,</span>
</span><span id="LRCTree.__init__-30"><a href="#LRCTree.__init__-30"><span class="linenos">30</span></a>            <span class="n">n_bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
</span><span id="LRCTree.__init__-31"><a href="#LRCTree.__init__-31"><span class="linenos">31</span></a>            <span class="o">**</span><span class="n">kwargs</span>
</span><span id="LRCTree.__init__-32"><a href="#LRCTree.__init__-32"><span class="linenos">32</span></a>    <span class="p">):</span>
</span><span id="LRCTree.__init__-33"><a href="#LRCTree.__init__-33"><span class="linenos">33</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="LRCTree.__init__-34"><a href="#LRCTree.__init__-34"><span class="linenos">34</span></a><span class="sd">        Parameters</span>
</span><span id="LRCTree.__init__-35"><a href="#LRCTree.__init__-35"><span class="linenos">35</span></a><span class="sd">        ----------</span>
</span><span id="LRCTree.__init__-36"><a href="#LRCTree.__init__-36"><span class="linenos">36</span></a><span class="sd">        max_depth : int or None (default None)</span>
</span><span id="LRCTree.__init__-37"><a href="#LRCTree.__init__-37"><span class="linenos">37</span></a><span class="sd">            The maximum depth the Tree can train to. If None, does not use</span>
</span><span id="LRCTree.__init__-38"><a href="#LRCTree.__init__-38"><span class="linenos">38</span></a><span class="sd">            depth as a stopping criteria</span>
</span><span id="LRCTree.__init__-39"><a href="#LRCTree.__init__-39"><span class="linenos">39</span></a><span class="sd">        min_samples_split : int (default 2)</span>
</span><span id="LRCTree.__init__-40"><a href="#LRCTree.__init__-40"><span class="linenos">40</span></a><span class="sd">            The minimum number of samples that have to be at a Node to make</span>
</span><span id="LRCTree.__init__-41"><a href="#LRCTree.__init__-41"><span class="linenos">41</span></a><span class="sd">            a split</span>
</span><span id="LRCTree.__init__-42"><a href="#LRCTree.__init__-42"><span class="linenos">42</span></a><span class="sd">        min_samples_leaf : int (default 1)</span>
</span><span id="LRCTree.__init__-43"><a href="#LRCTree.__init__-43"><span class="linenos">43</span></a><span class="sd">            The minimum number of samples that have to be at a leaf Node</span>
</span><span id="LRCTree.__init__-44"><a href="#LRCTree.__init__-44"><span class="linenos">44</span></a><span class="sd">        n_independent : int (default 1)</span>
</span><span id="LRCTree.__init__-45"><a href="#LRCTree.__init__-45"><span class="linenos">45</span></a><span class="sd">            The number of independent variables to use per multivariate split.</span>
</span><span id="LRCTree.__init__-46"><a href="#LRCTree.__init__-46"><span class="linenos">46</span></a><span class="sd">            This value can be set to 0, which will result in CART</span>
</span><span id="LRCTree.__init__-47"><a href="#LRCTree.__init__-47"><span class="linenos">47</span></a><span class="sd">        highest_degree : int (default 1)</span>
</span><span id="LRCTree.__init__-48"><a href="#LRCTree.__init__-48"><span class="linenos">48</span></a><span class="sd">            The highest degree to which to raise the independent variables</span>
</span><span id="LRCTree.__init__-49"><a href="#LRCTree.__init__-49"><span class="linenos">49</span></a><span class="sd">            in surface function learning</span>
</span><span id="LRCTree.__init__-50"><a href="#LRCTree.__init__-50"><span class="linenos">50</span></a><span class="sd">        fit_intercepts : bool (default True)</span>
</span><span id="LRCTree.__init__-51"><a href="#LRCTree.__init__-51"><span class="linenos">51</span></a><span class="sd">            Whether to fit intercepts in linear regression models</span>
</span><span id="LRCTree.__init__-52"><a href="#LRCTree.__init__-52"><span class="linenos">52</span></a><span class="sd">        method : str (default &#39;ols&#39;)</span>
</span><span id="LRCTree.__init__-53"><a href="#LRCTree.__init__-53"><span class="linenos">53</span></a><span class="sd">            One of &#39;ols&#39;, &#39;ridge&#39;, or &#39;lasso&#39;, the type of regression model to</span>
</span><span id="LRCTree.__init__-54"><a href="#LRCTree.__init__-54"><span class="linenos">54</span></a><span class="sd">            fit</span>
</span><span id="LRCTree.__init__-55"><a href="#LRCTree.__init__-55"><span class="linenos">55</span></a><span class="sd">        n_bins : int (default 10)</span>
</span><span id="LRCTree.__init__-56"><a href="#LRCTree.__init__-56"><span class="linenos">56</span></a><span class="sd">            The number of bins to use per independent variable in training</span>
</span><span id="LRCTree.__init__-57"><a href="#LRCTree.__init__-57"><span class="linenos">57</span></a><span class="sd">        **kwargs : additional keyword arguments</span>
</span><span id="LRCTree.__init__-58"><a href="#LRCTree.__init__-58"><span class="linenos">58</span></a><span class="sd">            Additional keyword arguments to pass to the linear regression models</span>
</span><span id="LRCTree.__init__-59"><a href="#LRCTree.__init__-59"><span class="linenos">59</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LRCTree.__init__-60"><a href="#LRCTree.__init__-60"><span class="linenos">60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span> <span class="o">=</span> <span class="n">max_depth</span>
</span><span id="LRCTree.__init__-61"><a href="#LRCTree.__init__-61"><span class="linenos">61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_split</span> <span class="o">=</span> <span class="n">min_samples_split</span>
</span><span id="LRCTree.__init__-62"><a href="#LRCTree.__init__-62"><span class="linenos">62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_leaf</span> <span class="o">=</span> <span class="n">min_samples_leaf</span>
</span><span id="LRCTree.__init__-63"><a href="#LRCTree.__init__-63"><span class="linenos">63</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_independent</span> <span class="o">=</span> <span class="n">n_independent</span>
</span><span id="LRCTree.__init__-64"><a href="#LRCTree.__init__-64"><span class="linenos">64</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">highest_degree</span> <span class="o">=</span> <span class="n">highest_degree</span>
</span><span id="LRCTree.__init__-65"><a href="#LRCTree.__init__-65"><span class="linenos">65</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit_intercepts</span> <span class="o">=</span> <span class="n">fit_intercepts</span>
</span><span id="LRCTree.__init__-66"><a href="#LRCTree.__init__-66"><span class="linenos">66</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
</span><span id="LRCTree.__init__-67"><a href="#LRCTree.__init__-67"><span class="linenos">67</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n_bins</span> <span class="o">=</span> <span class="n">n_bins</span>
</span><span id="LRCTree.__init__-68"><a href="#LRCTree.__init__-68"><span class="linenos">68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span>
</span><span id="LRCTree.__init__-69"><a href="#LRCTree.__init__-69"><span class="linenos">69</span></a>
</span><span id="LRCTree.__init__-70"><a href="#LRCTree.__init__-70"><span class="linenos">70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span> <span class="o">=</span> <span class="p">{}</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>max_depth</strong> (int or None (default None)):
The maximum depth the Tree can train to. If None, does not use
depth as a stopping criteria</li>
<li><strong>min_samples_split</strong> (int (default 2)):
The minimum number of samples that have to be at a Node to make
a split</li>
<li><strong>min_samples_leaf</strong> (int (default 1)):
The minimum number of samples that have to be at a leaf Node</li>
<li><strong>n_independent</strong> (int (default 1)):
The number of independent variables to use per multivariate split.
This value can be set to 0, which will result in CART</li>
<li><strong>highest_degree</strong> (int (default 1)):
The highest degree to which to raise the independent variables
in surface function learning</li>
<li><strong>fit_intercepts</strong> (bool (default True)):
Whether to fit intercepts in linear regression models</li>
<li><strong>method</strong> (str (default 'ols')):
One of 'ols', 'ridge', or 'lasso', the type of regression model to
fit</li>
<li><strong>n_bins</strong> (int (default 10)):
The number of bins to use per independent variable in training</li>
<li><strong>**kwargs</strong> (additional keyword arguments):
Additional keyword arguments to pass to the linear regression models</li>
</ul>
</div>


                            </div>
                            <div id="LRCTree.max_depth" class="classattr">
                                <div class="attr variable">
            <span class="name">max_depth</span>

        
    </div>
    <a class="headerlink" href="#LRCTree.max_depth"></a>
    
    

                            </div>
                            <div id="LRCTree.min_samples_split" class="classattr">
                                <div class="attr variable">
            <span class="name">min_samples_split</span>

        
    </div>
    <a class="headerlink" href="#LRCTree.min_samples_split"></a>
    
    

                            </div>
                            <div id="LRCTree.min_samples_leaf" class="classattr">
                                <div class="attr variable">
            <span class="name">min_samples_leaf</span>

        
    </div>
    <a class="headerlink" href="#LRCTree.min_samples_leaf"></a>
    
    

                            </div>
                            <div id="LRCTree.n_independent" class="classattr">
                                <div class="attr variable">
            <span class="name">n_independent</span>

        
    </div>
    <a class="headerlink" href="#LRCTree.n_independent"></a>
    
    

                            </div>
                            <div id="LRCTree.highest_degree" class="classattr">
                                <div class="attr variable">
            <span class="name">highest_degree</span>

        
    </div>
    <a class="headerlink" href="#LRCTree.highest_degree"></a>
    
    

                            </div>
                            <div id="LRCTree.fit_intercepts" class="classattr">
                                <div class="attr variable">
            <span class="name">fit_intercepts</span>

        
    </div>
    <a class="headerlink" href="#LRCTree.fit_intercepts"></a>
    
    

                            </div>
                            <div id="LRCTree.method" class="classattr">
                                <div class="attr variable">
            <span class="name">method</span>

        
    </div>
    <a class="headerlink" href="#LRCTree.method"></a>
    
    

                            </div>
                            <div id="LRCTree.n_bins" class="classattr">
                                <div class="attr variable">
            <span class="name">n_bins</span>

        
    </div>
    <a class="headerlink" href="#LRCTree.n_bins"></a>
    
    

                            </div>
                            <div id="LRCTree.kwargs" class="classattr">
                                <div class="attr variable">
            <span class="name">kwargs</span>

        
    </div>
    <a class="headerlink" href="#LRCTree.kwargs"></a>
    
    

                            </div>
                            <div id="LRCTree.depth" class="classattr">
                                <div class="attr variable">
            <span class="name">depth</span>

        
    </div>
    <a class="headerlink" href="#LRCTree.depth"></a>
    
    

                            </div>
                            <div id="LRCTree.nodes" class="classattr">
                                <div class="attr variable">
            <span class="name">nodes</span>

        
    </div>
    <a class="headerlink" href="#LRCTree.nodes"></a>
    
    

                            </div>
                            <div id="LRCTree.describe" class="classattr">
                                        <input id="LRCTree.describe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">describe</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span>)</span>

                <label class="view-source-button" for="LRCTree.describe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LRCTree.describe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LRCTree.describe-192"><a href="#LRCTree.describe-192"><span class="linenos">192</span></a>    <span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="LRCTree.describe-193"><a href="#LRCTree.describe-193"><span class="linenos">193</span></a>        <span class="sd">&quot;&quot;&quot;Print a description of the Tree&quot;&quot;&quot;</span>
</span><span id="LRCTree.describe-194"><a href="#LRCTree.describe-194"><span class="linenos">194</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span> <span class="o">==</span> <span class="p">{}:</span>
</span><span id="LRCTree.describe-195"><a href="#LRCTree.describe-195"><span class="linenos">195</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Empty Tree&#39;</span><span class="p">)</span>
</span><span id="LRCTree.describe-196"><a href="#LRCTree.describe-196"><span class="linenos">196</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LRCTree.describe-197"><a href="#LRCTree.describe-197"><span class="linenos">197</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="n">n</span><span class="o">.</span><span class="n">depth</span><span class="si">}{</span><span class="n">n</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="o">.</span><span class="n">values</span><span class="p">()]))</span>
</span></pre></div>


            <div class="docstring"><p>Print a description of the Tree</p>
</div>


                            </div>
                            <div id="LRCTree.fit" class="classattr">
                                        <input id="LRCTree.fit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span>, </span><span class="param"><span class="n">y</span></span>)</span>

                <label class="view-source-button" for="LRCTree.fit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LRCTree.fit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LRCTree.fit-291"><a href="#LRCTree.fit-291"><span class="linenos">291</span></a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="LRCTree.fit-292"><a href="#LRCTree.fit-292"><span class="linenos">292</span></a>        <span class="sd">&quot;&quot;&quot;Fit the Tree</span>
</span><span id="LRCTree.fit-293"><a href="#LRCTree.fit-293"><span class="linenos">293</span></a>
</span><span id="LRCTree.fit-294"><a href="#LRCTree.fit-294"><span class="linenos">294</span></a><span class="sd">        Parameters</span>
</span><span id="LRCTree.fit-295"><a href="#LRCTree.fit-295"><span class="linenos">295</span></a><span class="sd">        ----------</span>
</span><span id="LRCTree.fit-296"><a href="#LRCTree.fit-296"><span class="linenos">296</span></a><span class="sd">        x : 2d array-like</span>
</span><span id="LRCTree.fit-297"><a href="#LRCTree.fit-297"><span class="linenos">297</span></a><span class="sd">            The independent data to learn from</span>
</span><span id="LRCTree.fit-298"><a href="#LRCTree.fit-298"><span class="linenos">298</span></a><span class="sd">        y : 1d numpy array or pandas Series</span>
</span><span id="LRCTree.fit-299"><a href="#LRCTree.fit-299"><span class="linenos">299</span></a><span class="sd">            The target to learn</span>
</span><span id="LRCTree.fit-300"><a href="#LRCTree.fit-300"><span class="linenos">300</span></a>
</span><span id="LRCTree.fit-301"><a href="#LRCTree.fit-301"><span class="linenos">301</span></a><span class="sd">        Returns</span>
</span><span id="LRCTree.fit-302"><a href="#LRCTree.fit-302"><span class="linenos">302</span></a><span class="sd">        -------</span>
</span><span id="LRCTree.fit-303"><a href="#LRCTree.fit-303"><span class="linenos">303</span></a><span class="sd">        tree : LRCTree</span>
</span><span id="LRCTree.fit-304"><a href="#LRCTree.fit-304"><span class="linenos">304</span></a><span class="sd">            The fit tree (self)</span>
</span><span id="LRCTree.fit-305"><a href="#LRCTree.fit-305"><span class="linenos">305</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LRCTree.fit-306"><a href="#LRCTree.fit-306"><span class="linenos">306</span></a>
</span><span id="LRCTree.fit-307"><a href="#LRCTree.fit-307"><span class="linenos">307</span></a>        <span class="c1"># typechecking</span>
</span><span id="LRCTree.fit-308"><a href="#LRCTree.fit-308"><span class="linenos">308</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)):</span>
</span><span id="LRCTree.fit-309"><a href="#LRCTree.fit-309"><span class="linenos">309</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;x must be ndarray or pandas DataFrame&#39;</span><span class="p">)</span>
</span><span id="LRCTree.fit-310"><a href="#LRCTree.fit-310"><span class="linenos">310</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
</span><span id="LRCTree.fit-311"><a href="#LRCTree.fit-311"><span class="linenos">311</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;y must be ndarray or Series&#39;</span><span class="p">)</span>
</span><span id="LRCTree.fit-312"><a href="#LRCTree.fit-312"><span class="linenos">312</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="LRCTree.fit-313"><a href="#LRCTree.fit-313"><span class="linenos">313</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;y must have a single dimension&#39;</span><span class="p">)</span>
</span><span id="LRCTree.fit-314"><a href="#LRCTree.fit-314"><span class="linenos">314</span></a>
</span><span id="LRCTree.fit-315"><a href="#LRCTree.fit-315"><span class="linenos">315</span></a>        <span class="c1"># check the shapes of each variable</span>
</span><span id="LRCTree.fit-316"><a href="#LRCTree.fit-316"><span class="linenos">316</span></a>        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="LRCTree.fit-317"><a href="#LRCTree.fit-317"><span class="linenos">317</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Number of records does not match number of samples&#39;</span><span class="p">)</span>
</span><span id="LRCTree.fit-318"><a href="#LRCTree.fit-318"><span class="linenos">318</span></a>
</span><span id="LRCTree.fit-319"><a href="#LRCTree.fit-319"><span class="linenos">319</span></a>        <span class="c1"># if y is pandas Series, use only values (numpy array)</span>
</span><span id="LRCTree.fit-320"><a href="#LRCTree.fit-320"><span class="linenos">320</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
</span><span id="LRCTree.fit-321"><a href="#LRCTree.fit-321"><span class="linenos">321</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">values</span>
</span><span id="LRCTree.fit-322"><a href="#LRCTree.fit-322"><span class="linenos">322</span></a>
</span><span id="LRCTree.fit-323"><a href="#LRCTree.fit-323"><span class="linenos">323</span></a>        <span class="c1"># instantiate the Nodes</span>
</span><span id="LRCTree.fit-324"><a href="#LRCTree.fit-324"><span class="linenos">324</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="LRCTree.fit-325"><a href="#LRCTree.fit-325"><span class="linenos">325</span></a>
</span><span id="LRCTree.fit-326"><a href="#LRCTree.fit-326"><span class="linenos">326</span></a>        <span class="c1"># add the parent Node</span>
</span><span id="LRCTree.fit-327"><a href="#LRCTree.fit-327"><span class="linenos">327</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_add_nodes</span><span class="p">(</span><span class="n">Node</span><span class="p">())</span>
</span><span id="LRCTree.fit-328"><a href="#LRCTree.fit-328"><span class="linenos">328</span></a>
</span><span id="LRCTree.fit-329"><a href="#LRCTree.fit-329"><span class="linenos">329</span></a>        <span class="c1"># keep a record of all Node data for record keeping -- will be lost at the end however</span>
</span><span id="LRCTree.fit-330"><a href="#LRCTree.fit-330"><span class="linenos">330</span></a>        <span class="n">node_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LRCTree.fit-331"><a href="#LRCTree.fit-331"><span class="linenos">331</span></a>            <span class="mi">0</span><span class="p">:</span> <span class="p">{</span>
</span><span id="LRCTree.fit-332"><a href="#LRCTree.fit-332"><span class="linenos">332</span></a>                <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span>
</span><span id="LRCTree.fit-333"><a href="#LRCTree.fit-333"><span class="linenos">333</span></a>                <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span>
</span><span id="LRCTree.fit-334"><a href="#LRCTree.fit-334"><span class="linenos">334</span></a>            <span class="p">}</span>
</span><span id="LRCTree.fit-335"><a href="#LRCTree.fit-335"><span class="linenos">335</span></a>        <span class="p">}</span>
</span><span id="LRCTree.fit-336"><a href="#LRCTree.fit-336"><span class="linenos">336</span></a>
</span><span id="LRCTree.fit-337"><a href="#LRCTree.fit-337"><span class="linenos">337</span></a>        <span class="c1"># fitting logic is inside while loop</span>
</span><span id="LRCTree.fit-338"><a href="#LRCTree.fit-338"><span class="linenos">338</span></a>        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_depth</span><span class="p">:</span>
</span><span id="LRCTree.fit-339"><a href="#LRCTree.fit-339"><span class="linenos">339</span></a>
</span><span id="LRCTree.fit-340"><a href="#LRCTree.fit-340"><span class="linenos">340</span></a>            <span class="c1"># record current depth Nodes and how many Nodes exist to determine stopping criteria later</span>
</span><span id="LRCTree.fit-341"><a href="#LRCTree.fit-341"><span class="linenos">341</span></a>            <span class="n">current_depth_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">depth</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth</span><span class="p">]</span>
</span><span id="LRCTree.fit-342"><a href="#LRCTree.fit-342"><span class="linenos">342</span></a>            <span class="n">num_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
</span><span id="LRCTree.fit-343"><a href="#LRCTree.fit-343"><span class="linenos">343</span></a>
</span><span id="LRCTree.fit-344"><a href="#LRCTree.fit-344"><span class="linenos">344</span></a>            <span class="c1"># try to split all of the current depth Nodes</span>
</span><span id="LRCTree.fit-345"><a href="#LRCTree.fit-345"><span class="linenos">345</span></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">current_depth_nodes</span><span class="p">:</span>
</span><span id="LRCTree.fit-346"><a href="#LRCTree.fit-346"><span class="linenos">346</span></a>                <span class="n">split_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_split_node</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span><span class="p">,</span> <span class="n">node_data</span><span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
</span><span id="LRCTree.fit-347"><a href="#LRCTree.fit-347"><span class="linenos">347</span></a>                                                 <span class="n">node_data</span><span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
</span><span id="LRCTree.fit-348"><a href="#LRCTree.fit-348"><span class="linenos">348</span></a>
</span><span id="LRCTree.fit-349"><a href="#LRCTree.fit-349"><span class="linenos">349</span></a>                <span class="c1"># get the split information if there is an actual split to get</span>
</span><span id="LRCTree.fit-350"><a href="#LRCTree.fit-350"><span class="linenos">350</span></a>                <span class="c1"># remember -- if split_results is not None, the Node was actually split and new Nodes were added to the</span>
</span><span id="LRCTree.fit-351"><a href="#LRCTree.fit-351"><span class="linenos">351</span></a>                <span class="c1"># Tree</span>
</span><span id="LRCTree.fit-352"><a href="#LRCTree.fit-352"><span class="linenos">352</span></a>                <span class="k">if</span> <span class="n">split_results</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="LRCTree.fit-353"><a href="#LRCTree.fit-353"><span class="linenos">353</span></a>                    <span class="c1"># get the data for each side</span>
</span><span id="LRCTree.fit-354"><a href="#LRCTree.fit-354"><span class="linenos">354</span></a>                    <span class="n">less_id</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="LRCTree.fit-355"><a href="#LRCTree.fit-355"><span class="linenos">355</span></a>                    <span class="n">greater_id</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="LRCTree.fit-356"><a href="#LRCTree.fit-356"><span class="linenos">356</span></a>                    <span class="n">x_less</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="LRCTree.fit-357"><a href="#LRCTree.fit-357"><span class="linenos">357</span></a>                    <span class="n">x_greater</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span><span id="LRCTree.fit-358"><a href="#LRCTree.fit-358"><span class="linenos">358</span></a>                    <span class="n">y_less</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</span><span id="LRCTree.fit-359"><a href="#LRCTree.fit-359"><span class="linenos">359</span></a>                    <span class="n">y_greater</span> <span class="o">=</span> <span class="n">split_results</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</span><span id="LRCTree.fit-360"><a href="#LRCTree.fit-360"><span class="linenos">360</span></a>
</span><span id="LRCTree.fit-361"><a href="#LRCTree.fit-361"><span class="linenos">361</span></a>                    <span class="c1"># create the Nodes</span>
</span><span id="LRCTree.fit-362"><a href="#LRCTree.fit-362"><span class="linenos">362</span></a>                    <span class="n">node_data</span><span class="p">[</span><span class="n">less_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LRCTree.fit-363"><a href="#LRCTree.fit-363"><span class="linenos">363</span></a>                        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x_less</span><span class="p">,</span>
</span><span id="LRCTree.fit-364"><a href="#LRCTree.fit-364"><span class="linenos">364</span></a>                        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y_less</span>
</span><span id="LRCTree.fit-365"><a href="#LRCTree.fit-365"><span class="linenos">365</span></a>                    <span class="p">}</span>
</span><span id="LRCTree.fit-366"><a href="#LRCTree.fit-366"><span class="linenos">366</span></a>                    <span class="n">node_data</span><span class="p">[</span><span class="n">greater_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LRCTree.fit-367"><a href="#LRCTree.fit-367"><span class="linenos">367</span></a>                        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x_greater</span><span class="p">,</span>
</span><span id="LRCTree.fit-368"><a href="#LRCTree.fit-368"><span class="linenos">368</span></a>                        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y_greater</span>
</span><span id="LRCTree.fit-369"><a href="#LRCTree.fit-369"><span class="linenos">369</span></a>                    <span class="p">}</span>
</span><span id="LRCTree.fit-370"><a href="#LRCTree.fit-370"><span class="linenos">370</span></a>
</span><span id="LRCTree.fit-371"><a href="#LRCTree.fit-371"><span class="linenos">371</span></a>            <span class="c1"># if no new Nodes, then we are done</span>
</span><span id="LRCTree.fit-372"><a href="#LRCTree.fit-372"><span class="linenos">372</span></a>            <span class="n">new_num_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
</span><span id="LRCTree.fit-373"><a href="#LRCTree.fit-373"><span class="linenos">373</span></a>            <span class="k">if</span> <span class="n">new_num_nodes</span> <span class="o">==</span> <span class="n">num_nodes</span><span class="p">:</span>
</span><span id="LRCTree.fit-374"><a href="#LRCTree.fit-374"><span class="linenos">374</span></a>                <span class="k">break</span>
</span><span id="LRCTree.fit-375"><a href="#LRCTree.fit-375"><span class="linenos">375</span></a>
</span><span id="LRCTree.fit-376"><a href="#LRCTree.fit-376"><span class="linenos">376</span></a>        <span class="c1"># set _is_fit to True</span>
</span><span id="LRCTree.fit-377"><a href="#LRCTree.fit-377"><span class="linenos">377</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_is_fit</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="LRCTree.fit-378"><a href="#LRCTree.fit-378"><span class="linenos">378</span></a>
</span><span id="LRCTree.fit-379"><a href="#LRCTree.fit-379"><span class="linenos">379</span></a>        <span class="c1"># _values_to_predict helps with predicting probabilities</span>
</span><span id="LRCTree.fit-380"><a href="#LRCTree.fit-380"><span class="linenos">380</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">values_to_predict_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="LRCTree.fit-381"><a href="#LRCTree.fit-381"><span class="linenos">381</span></a>
</span><span id="LRCTree.fit-382"><a href="#LRCTree.fit-382"><span class="linenos">382</span></a>        <span class="c1"># _node_distributions helps with predicting</span>
</span><span id="LRCTree.fit-383"><a href="#LRCTree.fit-383"><span class="linenos">383</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">node_distributions_</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="LRCTree.fit-384"><a href="#LRCTree.fit-384"><span class="linenos">384</span></a>            <span class="n">n</span><span class="o">.</span><span class="n">identifier</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">node_data</span><span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">identifier</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values_to_predict_</span><span class="p">])</span>
</span><span id="LRCTree.fit-385"><a href="#LRCTree.fit-385"><span class="linenos">385</span></a>            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">split</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="LRCTree.fit-386"><a href="#LRCTree.fit-386"><span class="linenos">386</span></a>        <span class="p">}</span>
</span><span id="LRCTree.fit-387"><a href="#LRCTree.fit-387"><span class="linenos">387</span></a>
</span><span id="LRCTree.fit-388"><a href="#LRCTree.fit-388"><span class="linenos">388</span></a>        <span class="c1"># return self for consistency with scikit-learn</span>
</span><span id="LRCTree.fit-389"><a href="#LRCTree.fit-389"><span class="linenos">389</span></a>        <span class="k">return</span> <span class="bp">self</span>
</span></pre></div>


            <div class="docstring"><p>Fit the Tree</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>x</strong> (2d array-like):
The independent data to learn from</li>
<li><strong>y</strong> (1d numpy array or pandas Series):
The target to learn</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>tree</strong> (LRCTree):
The fit tree (self)</li>
</ul>
</div>


                            </div>
                            <div id="LRCTree.predict" class="classattr">
                                        <input id="LRCTree.predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span></span>)</span>

                <label class="view-source-button" for="LRCTree.predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LRCTree.predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LRCTree.predict-497"><a href="#LRCTree.predict-497"><span class="linenos">497</span></a>    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="LRCTree.predict-498"><a href="#LRCTree.predict-498"><span class="linenos">498</span></a>        <span class="sd">&quot;&quot;&quot;Predict classes for a set of values</span>
</span><span id="LRCTree.predict-499"><a href="#LRCTree.predict-499"><span class="linenos">499</span></a>
</span><span id="LRCTree.predict-500"><a href="#LRCTree.predict-500"><span class="linenos">500</span></a><span class="sd">        Parameters</span>
</span><span id="LRCTree.predict-501"><a href="#LRCTree.predict-501"><span class="linenos">501</span></a><span class="sd">        ----------</span>
</span><span id="LRCTree.predict-502"><a href="#LRCTree.predict-502"><span class="linenos">502</span></a><span class="sd">        x : pandas DataFrame</span>
</span><span id="LRCTree.predict-503"><a href="#LRCTree.predict-503"><span class="linenos">503</span></a><span class="sd">            Data to predict from</span>
</span><span id="LRCTree.predict-504"><a href="#LRCTree.predict-504"><span class="linenos">504</span></a>
</span><span id="LRCTree.predict-505"><a href="#LRCTree.predict-505"><span class="linenos">505</span></a><span class="sd">        Returns</span>
</span><span id="LRCTree.predict-506"><a href="#LRCTree.predict-506"><span class="linenos">506</span></a><span class="sd">        -------</span>
</span><span id="LRCTree.predict-507"><a href="#LRCTree.predict-507"><span class="linenos">507</span></a><span class="sd">        preds : numpy array</span>
</span><span id="LRCTree.predict-508"><a href="#LRCTree.predict-508"><span class="linenos">508</span></a><span class="sd">            Numpy array of predictions</span>
</span><span id="LRCTree.predict-509"><a href="#LRCTree.predict-509"><span class="linenos">509</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LRCTree.predict-510"><a href="#LRCTree.predict-510"><span class="linenos">510</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_fit</span><span class="p">:</span>
</span><span id="LRCTree.predict-511"><a href="#LRCTree.predict-511"><span class="linenos">511</span></a>            <span class="k">raise</span> <span class="n">NotFitError</span>
</span><span id="LRCTree.predict-512"><a href="#LRCTree.predict-512"><span class="linenos">512</span></a>
</span><span id="LRCTree.predict-513"><a href="#LRCTree.predict-513"><span class="linenos">513</span></a>        <span class="c1"># this function just applies the _predict_single_instance method to each of the rows</span>
</span><span id="LRCTree.predict-514"><a href="#LRCTree.predict-514"><span class="linenos">514</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_single_instance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">proba</span> <span class="o">=</span> <span class="kc">False</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict classes for a set of values</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>x</strong> (pandas DataFrame):
Data to predict from</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>preds</strong> (numpy array):
Numpy array of predictions</li>
</ul>
</div>


                            </div>
                            <div id="LRCTree.predict_proba" class="classattr">
                                        <input id="LRCTree.predict_proba-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">predict_proba</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span></span>)</span>

                <label class="view-source-button" for="LRCTree.predict_proba-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LRCTree.predict_proba"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LRCTree.predict_proba-516"><a href="#LRCTree.predict_proba-516"><span class="linenos">516</span></a>    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="LRCTree.predict_proba-517"><a href="#LRCTree.predict_proba-517"><span class="linenos">517</span></a>        <span class="sd">&quot;&quot;&quot;Predict class probabilities for a set of values</span>
</span><span id="LRCTree.predict_proba-518"><a href="#LRCTree.predict_proba-518"><span class="linenos">518</span></a>
</span><span id="LRCTree.predict_proba-519"><a href="#LRCTree.predict_proba-519"><span class="linenos">519</span></a><span class="sd">        Parameters</span>
</span><span id="LRCTree.predict_proba-520"><a href="#LRCTree.predict_proba-520"><span class="linenos">520</span></a><span class="sd">        ----------</span>
</span><span id="LRCTree.predict_proba-521"><a href="#LRCTree.predict_proba-521"><span class="linenos">521</span></a><span class="sd">        x : 2d array-like</span>
</span><span id="LRCTree.predict_proba-522"><a href="#LRCTree.predict_proba-522"><span class="linenos">522</span></a><span class="sd">            Data to predict from</span>
</span><span id="LRCTree.predict_proba-523"><a href="#LRCTree.predict_proba-523"><span class="linenos">523</span></a>
</span><span id="LRCTree.predict_proba-524"><a href="#LRCTree.predict_proba-524"><span class="linenos">524</span></a><span class="sd">        Returns</span>
</span><span id="LRCTree.predict_proba-525"><a href="#LRCTree.predict_proba-525"><span class="linenos">525</span></a><span class="sd">        -------</span>
</span><span id="LRCTree.predict_proba-526"><a href="#LRCTree.predict_proba-526"><span class="linenos">526</span></a><span class="sd">        preds : numpy array</span>
</span><span id="LRCTree.predict_proba-527"><a href="#LRCTree.predict_proba-527"><span class="linenos">527</span></a><span class="sd">            Numpy array of predicted probabilities. Column indices correspond to same classes</span>
</span><span id="LRCTree.predict_proba-528"><a href="#LRCTree.predict_proba-528"><span class="linenos">528</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LRCTree.predict_proba-529"><a href="#LRCTree.predict_proba-529"><span class="linenos">529</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_fit</span><span class="p">:</span>
</span><span id="LRCTree.predict_proba-530"><a href="#LRCTree.predict_proba-530"><span class="linenos">530</span></a>            <span class="k">raise</span> <span class="n">NotFitError</span>
</span><span id="LRCTree.predict_proba-531"><a href="#LRCTree.predict_proba-531"><span class="linenos">531</span></a>
</span><span id="LRCTree.predict_proba-532"><a href="#LRCTree.predict_proba-532"><span class="linenos">532</span></a>        <span class="c1"># apply predicting with probabilities</span>
</span><span id="LRCTree.predict_proba-533"><a href="#LRCTree.predict_proba-533"><span class="linenos">533</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">apply_along_axis</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_predict_single_instance</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">proba</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Predict class probabilities for a set of values</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>x</strong> (2d array-like):
Data to predict from</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>preds</strong> (numpy array):
Numpy array of predicted probabilities. Column indices correspond to same classes</li>
</ul>
</div>


                            </div>
                            <div id="LRCTree.score" class="classattr">
                                        <input id="LRCTree.score-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">score</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span>, </span><span class="param"><span class="n">y</span></span>)</span>

                <label class="view-source-button" for="LRCTree.score-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LRCTree.score"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LRCTree.score-535"><a href="#LRCTree.score-535"><span class="linenos">535</span></a>    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="LRCTree.score-536"><a href="#LRCTree.score-536"><span class="linenos">536</span></a>        <span class="sd">&quot;&quot;&quot;Score the model&#39;s performance on new labeled data using accuracy score as a measure</span>
</span><span id="LRCTree.score-537"><a href="#LRCTree.score-537"><span class="linenos">537</span></a>
</span><span id="LRCTree.score-538"><a href="#LRCTree.score-538"><span class="linenos">538</span></a><span class="sd">        Parameters</span>
</span><span id="LRCTree.score-539"><a href="#LRCTree.score-539"><span class="linenos">539</span></a><span class="sd">        ----------</span>
</span><span id="LRCTree.score-540"><a href="#LRCTree.score-540"><span class="linenos">540</span></a><span class="sd">        x : pandas DataFrame</span>
</span><span id="LRCTree.score-541"><a href="#LRCTree.score-541"><span class="linenos">541</span></a><span class="sd">            DataFrame to predict from</span>
</span><span id="LRCTree.score-542"><a href="#LRCTree.score-542"><span class="linenos">542</span></a><span class="sd">        y : pandas Series or 1d numpy array</span>
</span><span id="LRCTree.score-543"><a href="#LRCTree.score-543"><span class="linenos">543</span></a><span class="sd">            Labels for data</span>
</span><span id="LRCTree.score-544"><a href="#LRCTree.score-544"><span class="linenos">544</span></a>
</span><span id="LRCTree.score-545"><a href="#LRCTree.score-545"><span class="linenos">545</span></a><span class="sd">        Returns</span>
</span><span id="LRCTree.score-546"><a href="#LRCTree.score-546"><span class="linenos">546</span></a><span class="sd">        -------</span>
</span><span id="LRCTree.score-547"><a href="#LRCTree.score-547"><span class="linenos">547</span></a><span class="sd">        score : float</span>
</span><span id="LRCTree.score-548"><a href="#LRCTree.score-548"><span class="linenos">548</span></a><span class="sd">            Accuracy score of the model on its predictions of x</span>
</span><span id="LRCTree.score-549"><a href="#LRCTree.score-549"><span class="linenos">549</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LRCTree.score-550"><a href="#LRCTree.score-550"><span class="linenos">550</span></a>        <span class="n">preds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="LRCTree.score-551"><a href="#LRCTree.score-551"><span class="linenos">551</span></a>        <span class="k">return</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">preds</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Score the model's performance on new labeled data using accuracy score as a measure</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>x</strong> (pandas DataFrame):
DataFrame to predict from</li>
<li><strong>y</strong> (pandas Series or 1d numpy array):
Labels for data</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>score</strong> (float):
Accuracy score of the model on its predictions of x</li>
</ul>
</div>


                            </div>
                            <div id="LRCTree.fit_predict" class="classattr">
                                        <input id="LRCTree.fit_predict-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fit_predict</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">x</span>, </span><span class="param"><span class="n">y</span></span>)</span>

                <label class="view-source-button" for="LRCTree.fit_predict-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LRCTree.fit_predict"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LRCTree.fit_predict-553"><a href="#LRCTree.fit_predict-553"><span class="linenos">553</span></a>    <span class="k">def</span> <span class="nf">fit_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="LRCTree.fit_predict-554"><a href="#LRCTree.fit_predict-554"><span class="linenos">554</span></a>        <span class="sd">&quot;&quot;&quot;Fit the model and predict on X</span>
</span><span id="LRCTree.fit_predict-555"><a href="#LRCTree.fit_predict-555"><span class="linenos">555</span></a>
</span><span id="LRCTree.fit_predict-556"><a href="#LRCTree.fit_predict-556"><span class="linenos">556</span></a><span class="sd">        Parameters</span>
</span><span id="LRCTree.fit_predict-557"><a href="#LRCTree.fit_predict-557"><span class="linenos">557</span></a><span class="sd">        ----------</span>
</span><span id="LRCTree.fit_predict-558"><a href="#LRCTree.fit_predict-558"><span class="linenos">558</span></a><span class="sd">        x : pandas DataFrame</span>
</span><span id="LRCTree.fit_predict-559"><a href="#LRCTree.fit_predict-559"><span class="linenos">559</span></a><span class="sd">            DataFrame to train on and predict from</span>
</span><span id="LRCTree.fit_predict-560"><a href="#LRCTree.fit_predict-560"><span class="linenos">560</span></a><span class="sd">        y : pandas Series or 1d numpy array</span>
</span><span id="LRCTree.fit_predict-561"><a href="#LRCTree.fit_predict-561"><span class="linenos">561</span></a><span class="sd">            Labels for x to learn from</span>
</span><span id="LRCTree.fit_predict-562"><a href="#LRCTree.fit_predict-562"><span class="linenos">562</span></a>
</span><span id="LRCTree.fit_predict-563"><a href="#LRCTree.fit_predict-563"><span class="linenos">563</span></a><span class="sd">        Returns</span>
</span><span id="LRCTree.fit_predict-564"><a href="#LRCTree.fit_predict-564"><span class="linenos">564</span></a><span class="sd">        -------</span>
</span><span id="LRCTree.fit_predict-565"><a href="#LRCTree.fit_predict-565"><span class="linenos">565</span></a><span class="sd">        preds : 1d numpy array</span>
</span><span id="LRCTree.fit_predict-566"><a href="#LRCTree.fit_predict-566"><span class="linenos">566</span></a><span class="sd">            Predictions on x after fitting</span>
</span><span id="LRCTree.fit_predict-567"><a href="#LRCTree.fit_predict-567"><span class="linenos">567</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LRCTree.fit_predict-568"><a href="#LRCTree.fit_predict-568"><span class="linenos">568</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span><span id="LRCTree.fit_predict-569"><a href="#LRCTree.fit_predict-569"><span class="linenos">569</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Fit the model and predict on X</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>x</strong> (pandas DataFrame):
DataFrame to train on and predict from</li>
<li><strong>y</strong> (pandas Series or 1d numpy array):
Labels for x to learn from</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>preds</strong> (1d numpy array):
Predictions on x after fitting</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sklearn.base.BaseEstimator</dt>
                                <dd id="LRCTree.get_params" class="function">get_params</dd>
                <dd id="LRCTree.set_params" class="function">set_params</dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span><span class="signature">${doc.signature}:</span>`;
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value">${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>